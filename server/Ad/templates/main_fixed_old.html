{% extends 'base.html' %}
{% load static %}

{% block title %}–û—Ä–±–∏—Ç–∞ –ù–æ–≤–æ—Å—Ç–µ–π - –ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block style %}
<style>
    html, body {
        background-color: transparent !important;
        min-height: 100vh;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        scrollbar-width: thin;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞ */
    .enhanced-stars-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
        pointer-events: none;
        overflow: hidden;
    }
    
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∑–≤–µ–∑–¥ */
    .star {
        position: absolute;
        background-color: #fff;
        border-radius: 50%;
        opacity: 0;
        animation: twinkle var(--duration, 4s) ease-in-out infinite;
        animation-delay: var(--delay, 0s);
    }
    
    /* –†–∞–∑–º–µ—Ä—ã –∑–≤–µ–∑–¥ */
    .star.tiny {
        width: 1px;
        height: 1px;
        box-shadow: 0 0 1px rgba(255, 255, 255, 0.3);
    }
    
    .star.small {
        width: 2px;
        height: 2px;
        box-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
    }
    
    .star.medium {
        width: 3px;
        height: 3px;
        box-shadow: 0 0 3px 1px rgba(255, 255, 255, 0.6);
    }
    
    .star.large {
        width: 4px;
        height: 4px;
        box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.8);
    }
    
    /* –ó–≤–µ–∑–¥—ã —Å –æ—Å–æ–±—ã–º —Å–≤–µ—á–µ–Ω–∏–µ–º */
    .star.bright {
        background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.3) 70%, rgba(255, 255, 255, 0) 100%);
        width: 6px;
        height: 6px;
        box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.7);
        animation: bright-twinkle var(--duration, 6s) ease-in-out infinite;
        animation-delay: var(--delay, 0s);
    }
    
    /* –ü–∞–¥–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã (–º–µ—Ç–µ–æ—Ä—ã) */
    .meteor {
        position: absolute;
        width: 2px;
        height: 1px;
        background: linear-gradient(to right, rgba(255, 255, 255, 0), rgba(255, 255, 255, 1) 50%, rgba(255, 255, 255, 0));
        transform: rotate(-35deg);
        opacity: 0;
        top: calc(var(--top, 0.3) * 100%);
        left: calc(var(--left, 0.5) * 100%);
        animation: meteor 8s linear infinite;
        animation-delay: var(--delay, 0s);
        z-index: 1;
    }
    
    /* –¢—É–º–∞–Ω–Ω–æ—Å—Ç–∏ */
    .nebula {
        position: absolute;
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: radial-gradient(ellipse at center, 
                                    rgba(63, 81, 181, 0.05) 0%, 
                                    rgba(76, 0, 153, 0.03) 50%, 
                                    rgba(15, 11, 50, 0) 70%);
        opacity: 0.3;
        animation: pulse 15s ease-in-out infinite;
        animation-delay: var(--delay, 0s);
        transform: scale(var(--scale, 1));
        z-index: 0;
        mix-blend-mode: screen;
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes twinkle {
        0%, 100% { opacity: 0.1; transform: scale(1); }
        50% { opacity: 0.9; transform: scale(1.2); }
    }
    
    @keyframes bright-twinkle {
        0%, 100% { opacity: 0.5; transform: scale(1); filter: blur(0px); }
        25% { opacity: 1; transform: scale(1.1); filter: blur(0px); }
        50% { opacity: 0.7; transform: scale(1.3); filter: blur(1px); }
        75% { opacity: 1; transform: scale(1.1); filter: blur(0px); }
    }
    
    @keyframes meteor {
        0% {
            opacity: 0;
            width: 0;
            transform: translateX(0) translateY(0) rotate(-35deg);
        }
        5% {
            opacity: 1;
            width: 120px;
        }
        20% {
            opacity: 1;
        }
        30% {
            opacity: 0;
            width: 0;
            transform: translateX(900px) translateY(900px) rotate(-35deg);
        }
        100% {
            opacity: 0;
            width: 0;
            transform: translateX(900px) translateY(900px) rotate(-35deg);
        }
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 0.3; transform: scale(var(--scale, 1)); }
        50% { opacity: 0.5; transform: scale(calc(var(--scale, 1) * 1.2)); }
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ body */
    body::-webkit-scrollbar {
        width: 8px;
    }

    body::-webkit-scrollbar-track {
        background: transparent;
    }

    body::-webkit-scrollbar-thumb {
        background-color: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        border: 2px solid transparent;
    }

    body::-webkit-scrollbar-thumb:hover {
        background-color: rgba(255, 255, 255, 0.5);
    }

    /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –¥–µ–ª–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º —Ñ–æ–Ω–æ–º */
    .container, 
    .content-container,
    .wrapper,
    .page-wrapper,
    .main-wrapper {
        background-color: transparent !important;
    }

    .main-content {
        display: flex;
        justify-content: center;
        align-items: center;
        flex: 1;
        overflow: hidden;
        width: 100%;
        gap: 25px;
        padding: 15px 0;
        background-color: transparent;
        position: relative;
        z-index: 2;
        height: 100vh;
        max-width: 95%;
        margin: 0 auto;
    }

    .news-content, .qr-section {
        align-self: center;
    }

    .news-content {
        background-color: white;
        padding: 20px;
        border-radius: 30px;
        width: 60%;
        flex: 0 0 auto;
        overflow-y: auto;
        box-sizing: border-box;
        font-size: 1.5rem;
        margin: 0;
        scrollbar-width: thin;
        -ms-overflow-style: none;
        max-height: 75vh;
        position: relative;
    }

    /* –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è Chrome, Edge –∏ –¥—Ä—É–≥–∏—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ */
    .news-content::-webkit-scrollbar {
        width: 6px;
    }

    .news-content::-webkit-scrollbar-track {
        background: transparent;
    }

    .news-content::-webkit-scrollbar-thumb {
        background-color: rgba(35, 28, 92, 0.5);
        border-radius: 10px;
    }

    .news-content::-webkit-scrollbar-thumb:hover {
        background-color: rgba(35, 28, 92, 0.8);
    }

    .qr-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 30px;
        border-radius: 50px;
        margin: 0;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        width: 30%;
        flex: 0 0 auto;
        transition: all 0.3s ease;
        max-height: 70vh;
    }

    .qr-section:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .qr-section img {
        width: 85%;
        height: auto;
        min-width: 200px;
        min-height: 200px;
        max-width: 300px;
        max-height: 300px;
        transition: all 0.3s ease-in-out;
        border-radius: 15px;
        opacity: 1;
        margin-bottom: 15px;
    }

    .qr-section span {
        font-weight: bold;
        font-size: 1.5rem;
        color: white;
        margin-top: 8px;
    }

    .qr-source {
        font-weight: bold;
        font-size: 1.6rem;
        color: #1a237e;
        margin-top: 20px;
        text-align: center;
        transition: all 0.3s ease;
        padding: 10px 20px;
        background-color: rgba(255, 255, 255, 0.95);
        border-radius: 10px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        border: 1px solid #e0e0e0;
        position: relative;
        display: inline-block;
    }

    .qr-source:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        color: #3f51b5;
    }

    .qr-source::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        width: 0;
        height: 2px;
        background-color: #3f51b5;
        transition: all 0.3s ease;
        transform: translateX(-50%);
    }

    .qr-source:hover::after {
        width: 80%;
    }

    .news-content h2:first-of-type {
        margin-top: 0;
    }

    .news-content h2 {
        font-size: 2.5rem;
        font-weight: bold;
        margin-top: 0;
        margin-bottom: 15px;
    }

    .news-content p {
        font-size: 1.5rem;
        line-height: 1.6;
    }

    .news-item {
        margin-top: 0;
        position: relative;
    }

    .news-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 20px;
    }

    .navigation-buttons {
        display: flex;
        gap: 10px;
    }

    .nav-button {
        background-color: #231c5c;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 8px 15px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: background-color 0.3s, transform 0.2s;
    }

    .nav-button:hover {
        background-color: #1a1461;
        transform: translateY(-2px);
    }

    .nav-button:active {
        transform: translateY(0);
    }

    .timer-container {
        position: relative;
        width: 40px;
        height: 40px;
    }

    .timer-svg {
        transform: rotate(-90deg);
        width: 100%;
        height: 100%;
    }

    .timer-circle-bg {
        fill: none;
        stroke: #e6e6e6;
        stroke-width: 3.5;
    }

    .timer-circle-progress {
        fill: none;
        stroke: #231c5c;
        stroke-width: 3.5;
        stroke-linecap: round;
        stroke-dasharray: 125.6;
        stroke-dashoffset: 125.6;
        animation: countdown 20s linear forwards;
    }

    @keyframes countdown {
        from {
            stroke-dashoffset: 125.6;
        }
        to {
            stroke-dashoffset: 0;
        }
    }

    .timer-center {
        position: absolute;
        top: 5px;
        left: 5px;
        width: 30px;
        height: 30px;
        background-color: white;
        border-radius: 50%;
        z-index: 1;
    }

    .news-ratings {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .rating-button {
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        background: none;
        cursor: pointer;
        padding: 5px;
        transition: transform 0.2s, opacity 0.3s;
        opacity: 0.7;
        color: #231c5c;
    }

    .rating-button:hover {
        transform: scale(1.1);
        opacity: 1;
    }

    .rating-button.active {
        opacity: 1;
    }

    .like-button .rating-icon {
        position: relative;
        display: inline-block;
        width: 24px;
        height: 24px;
        vertical-align: middle;
        margin-right: 5px;
    }
    .like-button .rating-icon:before {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        width: 20px;
        height: 20px;
        background: #888888; /* –ò–∑–º–µ–Ω–µ–Ω–æ —Å –∑–µ–ª–µ–Ω–æ–≥–æ –Ω–∞ —Å–µ—Ä—ã–π */
        mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z"/></svg>');
        -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z"/></svg>');
    }

    .dislike-button .rating-icon {
        position: relative;
        display: inline-block;
        width: 24px;
        height: 24px;
        vertical-align: middle;
        margin-right: 5px;
    }
    .dislike-button .rating-icon:before {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        width: 20px;
        height: 20px;
        background: #888888; /* –ò–∑–º–µ–Ω–µ–Ω–æ —Å –∫—Ä–∞—Å–Ω–æ–≥–æ –Ω–∞ —Å–µ—Ä—ã–π */
        mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,15H23V3H19M15,3H6C5.17,3 4.46,3.5 4.16,4.22L1.14,11.27C1.05,11.5 1,11.74 1,12V14A2,2 0 0,0 3,16H9.31L8.36,20.57C8.34,20.67 8.33,20.77 8.33,20.88C8.33,21.3 8.5,21.67 8.77,21.94L9.83,23L16.41,16.41C16.78,16.05 17,15.55 17,15V5C17,3.89 16.1,3 15,3Z"/></svg>');
        -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,15H23V3H19M15,3H6C5.17,3 4.46,3.5 4.16,4.22L1.14,11.27C1.05,11.5 1,11.74 1,12V14A2,2 0 0,0 3,16H9.31L8.36,20.57C8.34,20.67 8.33,20.77 8.33,20.88C8.33,21.3 8.5,21.67 8.77,21.94L9.83,23L16.41,16.41C16.78,16.05 17,15.55 17,15V5C17,3.89 16.1,3 15,3Z"/></svg>');
    }

    .comment-button .rating-icon {
        position: relative;
        display: inline-block;
        width: 24px;
        height: 24px;
        vertical-align: middle;
        margin-right: 5px;
    }
    .comment-button .rating-icon:before {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        width: 20px;
        height: 20px;
        background: #888888; /* –ò–∑–º–µ–Ω–µ–Ω–æ —Å —Å–∏–Ω–µ–≥–æ –Ω–∞ —Å–µ—Ä—ã–π */
        mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9Z"/></svg>');
        -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9Z"/></svg>');
    }

    .like-button.active .rating-icon:before {
        background: #888888; /* –ò–∑–º–µ–Ω–µ–Ω–æ —Å –∑–µ–ª–µ–Ω–æ–≥–æ –Ω–∞ —Å–µ—Ä—ã–π */
    }

    .dislike-button.active .rating-icon:before {
        background: #888888; /* –ò–∑–º–µ–Ω–µ–Ω–æ —Å –∫—Ä–∞—Å–Ω–æ–≥–æ –Ω–∞ —Å–µ—Ä—ã–π */
    }

    .rating-count {
        font-size: 0.9rem;
    }

    .background-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1;
        opacity: 0.5;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ */
    .comments-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(8, 15, 30, 0.85); /* –¢—ë–º–Ω–æ-—Å–∏–Ω–∏–π –æ—Ç—Ç–µ–Ω–æ–∫, –∫–∞–∫ –∑–≤–µ–∑–¥–Ω–æ–µ –Ω–µ–±–æ, –Ω–æ —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é */
        backdrop-filter: blur(5px); /* –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–º—ã—Ç–∏–µ —Ñ–æ–Ω–∞ */
    }

    .comments-modal-content {
        position: relative;
        background-color: rgba(255, 255, 255, 0.95);
        margin: 5% auto;
        padding: 20px;
        border-radius: 15px;
        width: 60%;
        max-width: 800px;
        box-shadow: 0 5px 25px rgba(0, 0, 0, 0.4);
        animation: modalopen 0.3s;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    @keyframes modalopen {
        from {opacity: 0; transform: scale(0.9);}
        to {opacity: 1; transform: scale(1);}
    }

    .close-modal {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s;
    }

    .close-modal:hover,
    .close-modal:focus {
        color: #231c5c;
        text-decoration: none;
    }

    .comments-header {
        border-bottom: 1px solid #ddd;
        padding-bottom: 10px;
        margin-bottom: 15px;
    }

    .comments-header h3 {
        margin: 0;
        font-size: 1.5rem;
        color: #231c5c;
    }

    .comments-list {
        max-height: 400px;
        overflow-y: auto;
        margin-bottom: 20px;
    }

    .comment-item {
        padding: 10px;
        border-bottom: 1px solid #eee;
    }

    .comment-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
    }

    .comment-username {
        font-weight: bold;
        color: #231c5c;
    }

    .comment-date {
        color: #777;
        font-size: 0.8rem;
    }

    .comment-text {
        margin-bottom: 5px;
    }

    .comment-form {
        display: flex;
        flex-direction: column;
    }

    .comment-textarea {
        width: 100%;
        min-height: 80px;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        resize: vertical;
        font-family: inherit;
    }

    .comment-submit {
        align-self: flex-end;
        background-color: #231c5c;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 8px 15px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .comment-submit:hover {
        background-color: #3949ab;
    }

    .no-comments {
        text-align: center;
        color: #777;
        padding: 20px;
    }

    .error-message {
        color: #f44336;
        margin-bottom: 10px;
    }

    /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç–∏ */
    @media (max-width: 1200px) {
        .main-content {
            gap: 20px;
            max-width: 95%;
        }
        
        .news-content {
            width: 58%;
            margin: 0;
        }
        
        .qr-section {
            width: 35%;
            margin: 0;
        }
        
        .qr-section img {
            min-width: 180px;
            min-height: 180px;
            max-width: 250px;
            max-height: 250px;
        }
    }

    @media (max-width: 992px) {
        .main-content {
            flex-direction: column;
            align-items: center;
            padding: 10px 0;
        }
        
        .news-content {
            width: 90%;
            max-height: 60vh;
            margin: 0 0 15px 0;
        }
        
        .qr-section {
            width: 50%; /* –£–≤–µ–ª–∏—á–∏–≤–∞—é —à–∏—Ä–∏–Ω—É –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ */
            margin: 0;
            border-radius: 40px;
        }
        
        .qr-section img {
            width: 80%;
            border-radius: 12px;
            min-width: 200px;
            min-height: 200px;
            max-width: 250px;
            max-height: 250px;
        }
        
        .qr-source {
            font-size: 1.5rem;
            padding: 8px 15px;
        }
    }

    @media (max-width: 576px) {
        .main-content {
            padding: 5px 0;
        }
        
        .news-content {
            width: 95%;
            padding: 15px;
            margin: 0 0 10px 0;
        }
        
        .news-content h2 {
            font-size: 2rem;
        }
        
        .news-content p {
            font-size: 1.2rem;
        }
        
        .qr-section {
            width: 70%; /* –£–≤–µ–ª–∏—á–∏–≤–∞—é —à–∏—Ä–∏–Ω—É –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
            border-radius: 35px;
            padding: 20px;
            margin: 0;
        }
        
        .qr-source {
            font-size: 1.4rem;
            padding: 8px 15px;
        }
        
        .theme-switcher {
            top: 10px;
            right: 10px;
        }
        
        .theme-icon {
            width: 25px;
            height: 25px;
        }
        
        .theme-menu {
            width: 170px;
            right: -5px;
        }
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º */
    .theme-switcher {
        position: absolute;
        top: 12px;
        left: 180px; /* –ü–æ–∑–∏—Ü–∏—è —Å–ø—Ä–∞–≤–∞ –æ—Ç –ª–æ–≥–æ—Ç–∏–ø–∞ RTU MIREA */
        z-index: 1000;
    }
    
    .theme-icon {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid rgba(255, 255, 255, 0.7);
        overflow: hidden;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }
    
    .theme-icon:hover {
        transform: translateY(-2px);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
    }
    
    /* –°—Ç–∏–ª—å –¥–ª—è –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Ç–µ–º—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
    .theme-icon .icon-content {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #1a237e 0%, #4a148c 100%);
    }

    /* –°—Ç–∏–ª—å –¥–ª—è –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã */
    body.rainy-theme .theme-icon .icon-content {
        background: linear-gradient(135deg, #546e7a 0%, #37474f 100%);
    }
    
    .theme-menu {
        position: absolute;
        top: 40px;
        right: 0;
        background-color: rgba(255, 255, 255, 0.95);
        border-radius: 10px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        padding: 10px;
        display: none;
        width: 200px;
    }
    
    .theme-menu.visible {
        display: block;
        animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .theme-option {
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        transition: background-color 0.2s;
    }
    
    .theme-option:hover {
        background-color: rgba(35, 28, 92, 0.1);
    }
    
    .theme-option.active {
        background-color: rgba(35, 28, 92, 0.15);
    }
    
    .theme-color {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        margin-right: 10px;
    }
    
    .cosmic-theme .theme-color {
        background: linear-gradient(135deg, #1a237e 0%, #4a148c 100%);
    }
    
    .rainy-theme .theme-color {
        background: linear-gradient(135deg, #78909c 0%, #546e7a 100%);
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞ */
    .rainy-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
        pointer-events: none;
        overflow: hidden;
        background: linear-gradient(to bottom, #374046 0%, #546e7a 100%);
        display: none;
    }
    
    .raindrop {
        position: absolute;
        width: 2px;
        height: 15px;
        background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.6));
        border-radius: 20px;
        opacity: 0;
        animation: falling var(--duration, 1s) linear infinite;
        animation-delay: var(--delay, 0s);
        box-shadow: 0 0 2px rgba(255, 255, 255, 0.3);
    }
    
    .splash {
        position: absolute;
        width: 10px;
        height: 2px;
        background: rgba(255, 255, 255, 0.4);
        border-radius: 50%;
        opacity: 0;
        transform-origin: center;
        animation: splash 0.6s linear;
    }
    
    .mist {
        position: absolute;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, rgba(192, 210, 222, 0.1) 0%, rgba(176, 198, 209, 0.2) 100%);
        opacity: 0.3;
        pointer-events: none;
    }
    
    @keyframes falling {
        0% {
            transform: translateY(-100px);
            opacity: 0;
        }
        5% {
            opacity: 0.5;
        }
        95% {
            opacity: 0.5;
        }
        100% {
            transform: translateY(calc(100vh + 100px));
            opacity: 0;
        }
    }
    
    @keyframes splash {
        0% {
            transform: scale(0, 0);
            opacity: 0.7;
        }
        80% {
            transform: scale(1, 1);
            opacity: 0.5;
        }
        100% {
            transform: scale(2, 2);
            opacity: 0;
        }
    }
    
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã */
    body.rainy-theme .news-content {
        background-color: rgba(245, 250, 255, 0.92);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    }
    
    body.rainy-theme .news-content h2 {
        color: #37474f;
    }
    
    body.rainy-theme .news-content p {
        color: #455a64;
    }
    
    body.rainy-theme .qr-section {
        background-color: rgba(245, 250, 255, 0.9);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    }
    
    body.rainy-theme .qr-source {
        color: #37474f;
        background-color: rgba(236, 239, 241, 0.95);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
    }
    
    body.rainy-theme .qr-source:hover {
        color: #546e7a;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    body.rainy-theme .qr-source:hover::after {
        background-color: #546e7a;
    }
    
    body.rainy-theme .nav-button {
        background-color: #546e7a;
    }
    
    body.rainy-theme .nav-button:hover {
        background-color: #455a64;
    }
    
    body.rainy-theme .like-button .rating-icon,
    body.rainy-theme .dislike-button .rating-icon,
    body.rainy-theme .comment-button .rating-icon {
        filter: hue-rotate(220deg) saturate(0.8);
    }
    
    body.rainy-theme .timer-circle-progress {
        stroke: #546e7a;
    }
    
    body.rainy-theme .timer-container {
        opacity: 1;
        visibility: visible;
    }
    
    body.rainy-theme .timer-circle-bg {
        stroke: #eceff1;
    }
    
    body.rainy-theme .timer-center {
        background-color: #eceff1;
    }
    
    body.rainy-theme .news-ratings {
        color: #455a64;
    }
    
    body.rainy-theme .news-controls {
        border-top: 1px solid rgba(84, 110, 122, 0.2);
        padding-top: 15px;
        margin-top: 15px;
    }
    
    body.rainy-theme .news-content::-webkit-scrollbar-thumb {
        background-color: rgba(84, 110, 122, 0.5);
    }
    
    body.rainy-theme .news-content::-webkit-scrollbar-thumb:hover {
        background-color: rgba(84, 110, 122, 0.8);
    }
    
    body.rainy-theme body::-webkit-scrollbar-thumb {
        background-color: rgba(84, 110, 122, 0.3);
    }
    
    body.rainy-theme body::-webkit-scrollbar-thumb:hover {
        background-color: rgba(84, 110, 122, 0.5);
    }
    
    body.rainy-theme .comments-modal {
        background-color: rgba(55, 71, 79, 0.85);
    }
    
    body.rainy-theme .comments-modal-content {
        background-color: rgba(245, 250, 255, 0.95);
        box-shadow: 0 5px 25px rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(236, 239, 241, 0.6);
    }
    
    body.rainy-theme .comments-header h3 {
        color: #37474f;
    }
    
    body.rainy-theme .comment-username {
        color: #455a64;
    }
    
    body.rainy-theme .comment-submit {
        background-color: #546e7a;
    }
    
    body.rainy-theme .comment-submit:hover {
        background-color: #455a64;
    }
    
    body.rainy-theme .close-modal:hover,
    body.rainy-theme .close-modal:focus {
        color: #546e7a;
    }
    
    body.rainy-theme .comment-textarea {
        border-color: #b0bec5;
    }
    
    body.rainy-theme .comment-textarea:focus {
        border-color: #78909c;
        box-shadow: 0 0 5px rgba(120, 144, 156, 0.3);
    }
    
    body.rainy-theme .error-message {
        color: #e57373;
    }
    
    body.rainy-theme .theme-option.active {
        background-color: rgba(84, 110, 122, 0.15);
    }
    
    body.rainy-theme .theme-option:hover {
        background-color: rgba(84, 110, 122, 0.1);
    }

    body.rainy-theme .qr-section {
        background-color: rgba(245, 250, 255, 0.1);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        backdrop-filter: blur(5px);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ */
    .time-display {
        position: fixed;
        bottom: 8px;
        right: 20px;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 5px 10px;
        border-radius: 15px;
        font-weight: bold;
        color: #231c5c;
        z-index: 101;
    }

    body.rainy-theme .time-display {
        background-color: rgba(236, 239, 241, 0.7);
        color: #37474f;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º */
    .theme-switcher {
        position: absolute;
        top: 12px;
        left: 180px; /* –ü–æ–∑–∏—Ü–∏—è —Å–ø—Ä–∞–≤–∞ –æ—Ç –ª–æ–≥–æ—Ç–∏–ø–∞ RTU MIREA */
        z-index: 1000;
    }
    
    .theme-icon {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid rgba(255, 255, 255, 0.7);
        overflow: hidden;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }
    
    .theme-icon:hover {
        transform: translateY(-2px);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
    }

    body.rainy-theme .comment-submit:hover {
        background-color: #455a64;
    }

    body.rainy-theme .close-modal:hover,
    body.rainy-theme .close-modal:focus {
        color: #546e7a;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –≤ –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º–µ */
    body.rainy-theme .header {
        background-color: rgba(55, 71, 79, 0.85);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        border-bottom: 1px solid rgba(236, 239, 241, 0.3);
        z-index: 100;
        position: relative;
    }

    body.rainy-theme .nav-menu {
        z-index: 100;
    }

    body.rainy-theme .nav-link {
        color: rgba(236, 239, 241, 0.9);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    body.rainy-theme .nav-link:hover {
        color: #ffffff;
        background-color: rgba(84, 110, 122, 0.5);
    }

    body.rainy-theme .header span {
        color: rgba(236, 239, 241, 0.9);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–ª–Ω–∏–∏ */
    .lightning-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        pointer-events: none;
    }
    
    .lightning {
        position: absolute;
        top: 0;
        opacity: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0);
        animation: lightning-flash 0.3s linear;
        pointer-events: none;
    }
    
    @keyframes lightning-flash {
        0% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
        10% {
            opacity: 0.2;
            background-color: rgba(255, 255, 255, 0.2);
        }
        15% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
        20% {
            opacity: 0.9;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 0 30px 10px rgba(255, 255, 255, 0.8);
        }
        25% {
            opacity: 0.2;
            background-color: rgba(255, 255, 255, 0.2);
        }
        30% {
            opacity: 0.5;
            background-color: rgba(255, 255, 255, 0.5);
        }
        31% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
        100% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
    }
    
    /* –°—Ç–∏–ª—å –¥–ª—è –∑–≤—É–∫–∞ –≥—Ä–æ–º–∞ */
    .thunder-sound {
        display: none;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–µ–∫–∞—é—â–∏—Ö –∫–∞–ø–µ–ª—å */
    .flowing-drop {
        position: fixed;
        width: var(--width, 3px);
        height: var(--height, 15px);
        background: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.3) 100%);
        border-radius: 100% 100% 10% 10%;
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.6);
        opacity: 0;
        z-index: 98;
        pointer-events: none;
        transform-origin: center top;
        animation: flowing var(--duration, 8s) ease-in-out forwards;
        animation-delay: var(--delay, 0s);
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ç–µ–∫–∞–Ω–∏—è –∫–∞–ø–µ–ª—å */
    @keyframes flowing {
        0% {
            opacity: 0;
            transform: translateY(0) scaleY(1) translateX(0);
        }
        5% {
            opacity: 0.7;
        }
        20% {
            transform: translateY(var(--y1, 50px)) scaleY(1.2) translateX(var(--x1, 5px));
        }
        40% {
            transform: translateY(var(--y2, 100px)) scaleY(1.5) translateX(var(--x2, -8px));
        }
        60% {
            transform: translateY(var(--y3, 150px)) scaleY(1.8) translateX(var(--x3, 5px));
        }
        80% {
            transform: translateY(var(--y4, 200px)) scaleY(2) translateX(var(--x4, -5px));
            opacity: 0.7;
        }
        100% {
            transform: translateY(var(--y5, 300px)) scaleY(0.8) translateX(var(--x5, 0));
            opacity: 0;
        }
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–æ–Ω–∫–æ–π –ª–∏–Ω–∏–∏ –º–æ–ª–Ω–∏–∏ */
    .lightning-bolt {
        position: absolute;
        top: 0;
        width: 2px;
        height: 0;
        background-color: rgba(255, 255, 255, 0.9);
        filter: blur(1px);
        box-shadow: 
            0 0 5px rgba(255, 255, 255, 0.8),
            0 0 8px rgba(200, 220, 255, 0.8);
        opacity: 0;
        transform-origin: top center;
        z-index: 2;
        pointer-events: none;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –≤—Å–ø—ã—à–∫–∏ –º–æ–ª–Ω–∏–∏ */
    @keyframes lightning-flash {
        0% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
        10% {
            opacity: 0.2;
            background-color: rgba(255, 255, 255, 0.2);
        }
        15% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
        20% {
            opacity: 0.9;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 0 30px 10px rgba(255, 255, 255, 0.8);
        }
        25% {
            opacity: 0.2;
            background-color: rgba(255, 255, 255, 0.2);
        }
        30% {
            opacity: 0.5;
            background-color: rgba(255, 255, 255, 0.5);
        }
        31% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
        100% {
            opacity: 0;
            background-color: rgba(255, 255, 255, 0);
        }
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ª–∏–Ω–∏–∏ –º–æ–ª–Ω–∏–∏ */
    @keyframes lightning-bolt-appear {
        0% {
            opacity: 0;
            height: 0;
            transform: translateY(0) rotate(0deg);
        }
        5% {
            opacity: 1;
            height: var(--bolt-height);
            transform: translateY(0) rotate(var(--bolt-rotate, 0deg));
        }
        30% {
            opacity: 1;
        }
        100% {
            opacity: 0;
        }
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è –º–æ–ª–Ω–∏–∏ */
    @keyframes lightning-branch-appear {
        0% {
            opacity: 0;
            width: 0;
            transform: translateY(var(--branch-y)) rotate(var(--branch-rotate, 30deg));
        }
        20% {
            opacity: 1;
            width: var(--branch-width);
        }
        80% {
            opacity: 1;
        }
        100% {
            opacity: 0;
        }
    }

    /* –ù–æ–≤—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º */
    .simple-theme-switcher {
        position: fixed;
        top: 60px;
        right: 20px;
        z-index: 2000;
        display: flex;
        gap: 10px;
    }
    
    .theme-button {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid white;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .theme-button:hover {
        transform: scale(1.1);
    }
    
    .cosmic-button {
        background: linear-gradient(135deg, #1a237e 0%, #4a148c 100%);
    }
    
    .rainy-button {
        background: linear-gradient(135deg, #546e7a 0%, #37474f 100%);
    }
    
    .theme-button.active {
        border: 3px solid #ffeb3b;
    }
    
    .theme-button-icon {
        color: white;
        font-size: 20px;
    }

    /* –ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–µ–º */
    .theme-circle-menu {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 10000;
    }
    
    .theme-circle-toggle {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #5e35b1, #3949ab);
        border-radius: 50%;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: white;
        font-size: 22px;
        transition: all 0.3s ease;
    }
    
    .theme-circle-toggle:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .theme-circle-menu-items {
        position: absolute;
        bottom: 60px;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 10px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        display: none;
        flex-direction: column;
        gap: 10px;
        width: 180px;
    }
    
    .theme-circle-menu-items.active {
        display: flex;
        animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .theme-option {
        display: flex;
        align-items: center;
        padding: 8px 12px;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .theme-option:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }
    
    .theme-option-icon {
        width: 24px;
        height: 24px;
        margin-right: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .theme-option-label {
        font-size: 14px;
        font-weight: 500;
    }
    
    .theme-option.cosmic .theme-option-icon {
        background: linear-gradient(135deg, #000428, #004e92);
        border-radius: 50%;
        color: white;
    }
    
    .theme-option.rainy .theme-option-icon {
        background: linear-gradient(135deg, #37474f, #546e7a);
        border-radius: 50%;
        color: white;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–º—ã –≤ –º–µ–Ω—é */
    .theme-option.active {
        background-color: rgba(0, 0, 0, 0.07);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .theme-option.active::after {
        content: '‚úì';
        position: absolute;
        right: 12px;
        color: #4caf50;
        font-weight: bold;
    }
    
    /* –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª—å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è */
    .theme-circle-menu-items .theme-option {
        position: relative;
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ –¥–ª—è –∫—Ä—É–≥–ª–æ–π –∫–Ω–æ–ø–∫–∏ */
    @keyframes pulse {
        0% { transform: scale(1); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); }
        50% { transform: scale(1.05); box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3); }
        100% { transform: scale(1); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); }
    }
    
    .theme-circle-toggle.pulse {
        animation: pulse 1.5s infinite;
    }

    @keyframes floating {
        0% { transform: translateY(0px); }
        50% { transform: translateY(20px); }
        100% { transform: translateY(0px); }
    }

    @keyframes disappear {
        0% {
            opacity: 1;
        }
        100% {
            opacity: 0;
        }
    }

    /* –ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º */
    #theme-circle-menu {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        user-select: none;
        cursor: move;
        touch-action: none;
        transition: transform 0.2s ease;
    }
    
    #theme-circle-menu.dragging {
        transform: scale(0.95);
        opacity: 0.8;
    }
    
    /* –¶–≤–µ—Ç –∫—Ä—É–∂–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã */
    .cosmic-theme .theme-circle-toggle {
        background: linear-gradient(135deg, #3b1b78, #1a237e);
    }
    
    .rainy-theme .theme-circle-toggle {
        background: linear-gradient(135deg, #37474f, #546e7a);
    }
    
    /* –î–µ—Ñ–æ–ª—Ç–Ω—ã–π —Å—Ç–∏–ª—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã) */
    .theme-circle-toggle {
        background: linear-gradient(135deg, #3b1b78, #1a237e);
    }
</style>
{% endblock %}

{% block content %}
<!-- –£–ª—É—á—à–µ–Ω–Ω—ã–π –∑–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω -->
<div class="enhanced-stars-container" id="enhanced-stars">
    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–≤–µ–∑–¥—ã –∏ –º–µ—Ç–µ–æ—Ä—ã -->
</div>

<!-- –î–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç—ã–π) -->
<div class="rainy-background" id="rainy-background">
    <div class="mist"></div>
    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è -->
</div>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º–æ–ª–Ω–∏–π -->
<div class="lightning-container" id="lightning-container"></div>

<!-- –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –∑–≤—É–∫–∞ –≥—Ä–æ–º–∞ (—Å–∫—Ä—ã—Ç) -->
<audio class="thunder-sound" id="thunder-sound">
    <source src="{% static 'Ad/sounds/thunder.mp3' %}" type="audio/mp3">
</audio>

<!-- –ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ç–µ–º (—Å–∫—Ä—ã—Ç–æ, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ö–µ–¥–µ—Ä–µ) -->
<div class="theme-circle-menu" id="theme-circle-menu" style="display: none;">
    <div class="theme-circle-toggle" id="theme-circle-toggle">
        <i>‚ö™Ô∏è</i>
    </div>
    <div class="theme-circle-menu-items" id="theme-circle-menu-items">
        <div class="theme-option cosmic" data-theme="cosmic">
            <div class="theme-option-icon">‚ú®</div>
            <div class="theme-option-label">–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞</div>
        </div>
        <div class="theme-option rainy" data-theme="rainy">
            <div class="theme-option-icon">üåßÔ∏è</div>
            <div class="theme-option-label">–î–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞</div>
        </div>
    </div>
</div>

<div class="main-content">
    <div class="news-content">
        {% for news in news_list %}
        <div class="news-item" data-index="{{ forloop.counter0 }}" data-id="{{ news.id }}" data-source-url="{% if news.source %}{{ news.source.feed_url }}{% endif %}">
            <h2>{{ news.title }}</h2>
            <p>{{ news.description }}</p>
            <div class="news-controls">
                <div class="news-ratings">
                    <button class="rating-button like-button {% if news.user_rating == 'like' %}active{% endif %}" data-news-id="{{ news.id }}" data-rating="like">
                        <span class="rating-icon"></span>
                        <span class="rating-count">{{ news.likes_count }}</span>
                    </button>
                    <button class="rating-button dislike-button {% if news.user_rating == 'dislike' %}active{% endif %}" data-news-id="{{ news.id }}" data-rating="dislike">
                        <span class="rating-icon"></span>
                        <span class="rating-count">{{ news.dislikes_count }}</span>
                    </button>
                    <button class="rating-button comment-button" data-news-id="{{ news.id }}">
                        <span class="rating-icon"></span>
                        <span class="rating-count">{{ news.comments_count }}</span>
                    </button>
                </div>
                <div class="navigation-buttons">
                    <button class="nav-button back-button" data-index="{{ forloop.counter0 }}">–ù–∞–∑–∞–¥</button>
                    <button class="nav-button skip-button" data-index="{{ forloop.counter0 }}">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
                </div>
                <div class="timer-container">
                    <svg class="timer-svg" viewBox="0 0 44 44">
                        <circle class="timer-circle-bg" cx="22" cy="22" r="20"></circle>
                        <circle class="timer-circle-progress" cx="22" cy="22" r="20"></circle>
                    </svg>
                    <div class="timer-center"></div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="qr-section">
        <img id="qr-image" src="{% static 'Ad/images/qr-placeholder.png' %}" alt="QR –∫–æ–¥">
        <div class="qr-source" id="qr-source">–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ–≤–æ—Å—Ç–∏</div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ -->
<div id="comments-modal" class="comments-modal">
    <div class="comments-modal-content">
        <span class="close-modal">&times;</span>
        <div class="comments-header">
            <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
        </div>
        <div class="comments-list" id="comments-list">
            <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
            <div class="no-comments">
                –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!
            </div>
        </div>
        <div class="comment-form" id="comment-form">
            <div class="error-message" id="comment-error" style="display: none;"></div>
            <textarea class="comment-textarea" id="comment-text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
            <button class="comment-submit" id="comment-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π —Ç–µ–º
    document.addEventListener('DOMContentLoaded', function() {
        console.log('== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π —Ç–µ–º ==');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM-—Å—Ç—Ä—É–∫—Ç—É—Ä—É
        const rainyBackground = document.getElementById('rainy-background');
        const enhancedStars = document.getElementById('enhanced-stars');
        
        console.log('–≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ–Ω–∞:');
        console.log('- rainy-background:', rainyBackground ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- enhanced-stars:', enhancedStars ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
        window.rainyBackground = rainyBackground;
        window.enhancedStars = enhancedStars;
        
        // *** 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º ***
        const themeToggle = document.getElementById('theme-toggle-button');
        const themeMenu = document.getElementById('theme-menu');
        const themeOptions = document.querySelectorAll('.theme-menu .theme-option');
        
        if (themeToggle && themeMenu) {
            console.log('–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–µ–Ω—é —Ç–µ–º –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é
            themeToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                themeMenu.classList.toggle('visible');
                console.log('–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–µ–Ω—é —Ç–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ');
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (themeMenu.classList.contains('visible') && 
                    !themeMenu.contains(e.target) && 
                    e.target !== themeToggle) {
                    themeMenu.classList.remove('visible');
                    console.log('–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–µ–Ω—é —Ç–µ–º –∑–∞–∫—Ä—ã—Ç–æ (–∫–ª–∏–∫ –≤–Ω–µ)');
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    console.log(`–í—ã–±—Ä–∞–Ω–∞ —Ç–µ–º–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–µ–Ω—é): ${theme}`);
                    applyTheme(theme);
                    themeMenu.classList.remove('visible');
                });
            });
        } else {
            console.warn('–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–µ–Ω—é —Ç–µ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        }
        
        // *** 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é —Ç–µ–º ***
        const themeCircleToggle = document.getElementById('theme-circle-toggle');
        const themeCircleMenuItems = document.getElementById('theme-circle-menu-items');
        const circleThemeOptions = document.querySelectorAll('.theme-circle-menu-items .theme-option');
        const themeCircleMenu = document.getElementById('theme-circle-menu');
        
        if (themeCircleToggle && themeCircleMenuItems) {
            console.log('–ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é —Ç–µ–º –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏');
            
            // === –ö–æ–¥ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é ===
            if (themeCircleMenu) {
                console.log('–î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –¥–ª—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é');
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
                const savedPosition = JSON.parse(localStorage.getItem('themeCirclePosition') || '{}');
                if (savedPosition.bottom !== undefined && savedPosition.right !== undefined) {
                    themeCircleMenu.style.bottom = savedPosition.bottom + 'px';
                    themeCircleMenu.style.right = savedPosition.right + 'px';
                } else if (savedPosition.bottom !== undefined && savedPosition.left !== undefined) {
                    themeCircleMenu.style.bottom = savedPosition.bottom + 'px';
                    themeCircleMenu.style.right = 'auto';
                    themeCircleMenu.style.left = savedPosition.left + 'px';
                } else if (savedPosition.top !== undefined && savedPosition.right !== undefined) {
                    themeCircleMenu.style.top = savedPosition.top + 'px';
                    themeCircleMenu.style.bottom = 'auto';
                    themeCircleMenu.style.right = savedPosition.right + 'px';
                } else if (savedPosition.top !== undefined && savedPosition.left !== undefined) {
                    themeCircleMenu.style.top = savedPosition.top + 'px';
                    themeCircleMenu.style.bottom = 'auto';
                    themeCircleMenu.style.right = 'auto';
                    themeCircleMenu.style.left = savedPosition.left + 'px';
                }
                
                // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
                let isDragging = false;
                let lastX = 0;
                let lastY = 0;
                let animationFrameId = null;
                
                // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—é
                let menuState = {
                    top: null,
                    left: null,
                    bottom: null,
                    right: null
                };
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                function updateMenuState() {
                    const rect = themeCircleMenu.getBoundingClientRect();
                    const isTop = rect.top <= window.innerHeight / 2;
                    const isLeft = rect.left <= window.innerWidth / 2;
                    
                    menuState = {
                        isTop,
                        isLeft,
                        top: isTop ? parseInt(themeCircleMenu.style.top) || rect.top : null,
                        left: isLeft ? parseInt(themeCircleMenu.style.left) || rect.left : null,
                        bottom: !isTop ? parseInt(themeCircleMenu.style.bottom) || (window.innerHeight - rect.bottom) : null,
                        right: !isLeft ? parseInt(themeCircleMenu.style.right) || (window.innerWidth - rect.right) : null
                    };
                }
                
                // –í—ã–∑—ã–≤–∞–µ–º –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                updateMenuState();
                
                // –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –º–µ–Ω—é
                themeCircleToggle.addEventListener('mousedown', function(e) {
                    if (themeCircleMenuItems.classList.contains('active')) {
                        // –ï—Å–ª–∏ –º–µ–Ω—é –æ—Ç–∫—Ä—ã—Ç–æ, –Ω–µ –Ω–∞—á–∏–Ω–∞–µ–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
                        return;
                    }
                    
                    isDragging = true;
                    
                    // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –∫—É—Ä—Å–æ—Ä–∞
                    lastX = e.clientX;
                    lastY = e.clientY;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—é
                    updateMenuState();
                    
                    // –ó–∞–ø—Ä–µ—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
                    e.preventDefault();
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
                    themeCircleMenu.classList.add('dragging');
                    
                    // –û—Ç–º–µ–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–ø—Ä–æ—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –µ—Å–ª–∏ –æ–Ω –±—ã–ª
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                    }
                });
                
                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è –º–µ–Ω—é
                function updateMenuPosition(clientX, clientY) {
                    const deltaX = clientX - lastX;
                    const deltaY = clientY - lastY;
                    
                    lastX = clientX;
                    lastY = clientY;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∏–≤—è–∑–∫–∏
                    if (menuState.isTop) {
                        menuState.top = Math.max(0, menuState.top + deltaY);
                    } else {
                        menuState.bottom = Math.max(0, menuState.bottom - deltaY);
                    }
                    
                    if (menuState.isLeft) {
                        menuState.left = Math.max(0, menuState.left + deltaX);
                    } else {
                        menuState.right = Math.max(0, menuState.right - deltaX);
                    }
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º transform –≤–º–µ—Å—Ç–æ top/right/bottom/left
                    // –¥–ª—è –±–æ–ª—å—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    if (menuState.isTop) {
                        themeCircleMenu.style.top = menuState.top + 'px';
                        themeCircleMenu.style.bottom = 'auto';
                    } else {
                        themeCircleMenu.style.bottom = menuState.bottom + 'px';
                        themeCircleMenu.style.top = 'auto';
                    }
                    
                    if (menuState.isLeft) {
                        themeCircleMenu.style.left = menuState.left + 'px';
                        themeCircleMenu.style.right = 'auto';
                    } else {
                        themeCircleMenu.style.right = menuState.right + 'px';
                        themeCircleMenu.style.left = 'auto';
                    }
                }
                
                // –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–≤–∏–≥–∞–µ—Ç –º—ã—à—å—é
                document.addEventListener('mousemove', function(e) {
                    if (!isDragging) return;
                    
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                    }
                    
                    animationFrameId = requestAnimationFrame(() => {
                        updateMenuPosition(e.clientX, e.clientY);
                });
            });
                
                // –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—É—Å–∫–∞–µ—Ç –∫–Ω–æ–ø–∫—É –º—ã—à–∏
                document.addEventListener('mouseup', function() {
                    if (!isDragging) return;
                    
                    isDragging = false;
                    
                    // –û—Ç–º–µ–Ω—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                        animationFrameId = null;
                    }
                    
                    // –£–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏
                    themeCircleMenu.classList.remove('dragging');
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é –≤ localStorage
                    const position = {};
                    
                    if (menuState.isTop) {
                        position.top = menuState.top;
        } else {
                        position.bottom = menuState.bottom;
                    }
                    
                    if (menuState.isLeft) {
                        position.left = menuState.left;
                    } else {
                        position.right = menuState.right;
                    }
                    
                    localStorage.setItem('themeCirclePosition', JSON.stringify(position));
                    console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏—è –º–µ–Ω—é:', position);
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ç–∞—á-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                themeCircleToggle.addEventListener('touchstart', function(e) {
                    if (themeCircleMenuItems.classList.contains('active')) return;
                    
                    isDragging = true;
                    
                    // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
                    const touch = e.touches[0];
                    lastX = touch.clientX;
                    lastY = touch.clientY;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—é
                    updateMenuState();
                    
                    // –ó–∞–ø—Ä–µ—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
                    e.preventDefault();
                    
                    themeCircleMenu.classList.add('dragging');
                    
                    // –û—Ç–º–µ–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–ø—Ä–æ—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –µ—Å–ª–∏ –æ–Ω –±—ã–ª
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                    }
                });
                
                document.addEventListener('touchmove', function(e) {
                    if (!isDragging) return;
                    
                    const touch = e.touches[0];
                    
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                    }
                    
                    animationFrameId = requestAnimationFrame(() => {
                        updateMenuPosition(touch.clientX, touch.clientY);
                    });
                });
                
                document.addEventListener('touchend', function() {
                    if (!isDragging) return;
                    
                    isDragging = false;
                    
                    // –û—Ç–º–µ–Ω—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                        animationFrameId = null;
                    }
                    
                    themeCircleMenu.classList.remove('dragging');
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é –≤ localStorage
                    const position = {};
                    
                    if (menuState.isTop) {
                        position.top = menuState.top;
        } else {
                        position.bottom = menuState.bottom;
                    }
                    
                    if (menuState.isLeft) {
                        position.left = menuState.left;
                    } else {
                        position.right = menuState.right;
                    }
                    
                    localStorage.setItem('themeCirclePosition', JSON.stringify(position));
                    console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏—è –º–µ–Ω—é (—Ç–∞—á):', position);
                });
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—É–ª—å—Å–∞—Ü–∏–∏
            themeCircleToggle.classList.add('pulse');
            
            // –£–±–∏—Ä–∞–µ–º –ø—É–ª—å—Å–∞—Ü–∏—é —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                themeCircleToggle.classList.remove('pulse');
            }, 5000);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫—Ä—É–∂–∫—É - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é
            themeCircleToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                themeCircleMenuItems.classList.toggle('active');
                console.log('–ú–µ–Ω—é —Ç–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ');
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (themeCircleMenuItems.classList.contains('active') && 
                    !themeCircleMenuItems.contains(e.target) && 
                    e.target !== themeCircleToggle) {
                    themeCircleMenuItems.classList.remove('active');
                    console.log('–ú–µ–Ω—é —Ç–µ–º –∑–∞–∫—Ä—ã—Ç–æ (–∫–ª–∏–∫ –≤–Ω–µ)');
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã
            circleThemeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    console.log(`–í—ã–±—Ä–∞–Ω–∞ —Ç–µ–º–∞ (–∫—Ä—É–≥–ª–æ–µ –º–µ–Ω—é): ${theme}`);
                    applyTheme(theme);
                    updateActiveThemeOptions(theme);
                    themeCircleMenuItems.classList.remove('active');
                });
            });
        } else {
            console.warn('–ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é —Ç–µ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        }
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        const savedTheme = localStorage.getItem('theme') || 'cosmic';
        console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–∞ —Ç–µ–º–∞:', savedTheme);
        applyTheme(savedTheme);
        updateActiveButtons(savedTheme);
        updateActiveThemeOptions(savedTheme);
        
        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
        function applyTheme(theme) {
            console.log('–û—Å–Ω–æ–≤–Ω–æ–π applyTheme –∏–∑ main.html –≤—ã–∑–≤–∞–Ω —Å —Ç–µ–º–æ–π:', theme);
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ base.html, –µ—Å–ª–∏ –æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            if (window.applyTheme !== undefined && typeof window.applyTheme === 'function' && this !== window) {
                console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é window.applyTheme');
                window.applyTheme(theme);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                const rainyBackground = document.getElementById('rainy-background');
                const enhancedStars = document.getElementById('enhanced-stars');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Ñ–æ–Ω–æ–≤
                if (enhancedStars && rainyBackground) {
                    if (theme === 'cosmic') {
                        enhancedStars.style.display = 'block';
                        rainyBackground.style.display = 'none';
                        
                        // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
                        const allDrops = document.querySelectorAll('.raindrop');
                        allDrops.forEach(drop => {
                            if (drop.parentNode) drop.parentNode.removeChild(drop);
                        });
                    } else if (theme === 'rainy') {
                        enhancedStars.style.display = 'none';
                        rainyBackground.style.display = 'block';
                        
                        // –°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                        if (!rainyBackground.querySelector('.raindrop')) {
                            window.createRainyBackground();
                        }
                    }
                }
                return;
            }
            
            // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –µ—Å–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
            console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é applyTheme');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –Ω–∞ body –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –Ω–æ–≤—ã–º —Å—Ç–∏–ª–µ–º
            document.body.className = '';
            document.body.classList.add('theme-' + theme);
            
            // –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª—è–µ–º –∏ —Å—Ç–∞—Ä—ã–µ –∫–ª–∞—Å—Å—ã
            if (theme === 'cosmic') {
                document.body.classList.add('cosmic-theme');
            } else if (theme === 'rainy') {
                document.body.classList.add('rainy-theme');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Ñ–æ–Ω–æ–≤
            const rainyBackground = document.getElementById('rainy-background');
            const enhancedStars = document.getElementById('enhanced-stars');
            
            if (enhancedStars && rainyBackground) {
                if (theme === 'cosmic') {
                    enhancedStars.style.display = 'block';
                    rainyBackground.style.display = 'none';
                    
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
                    const allDrops = document.querySelectorAll('.raindrop');
                    allDrops.forEach(drop => {
                        if (drop.parentNode) drop.parentNode.removeChild(drop);
                    });
                } else if (theme === 'rainy') {
                    enhancedStars.style.display = 'none';
                    rainyBackground.style.display = 'block';
                    
                    // –°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                    if (!rainyBackground.querySelector('.raindrop')) {
                        window.createRainyBackground();
                    }
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ localStorage
            localStorage.setItem('theme', theme);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
        function updateActiveButtons(theme) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
            if (simpleCosmicButton && simpleRainyButton) {
                if (theme === 'cosmic') {
                    simpleCosmicButton.classList.add('active');
                    simpleRainyButton.classList.remove('active');
                } else {
                    simpleCosmicButton.classList.remove('active');
                    simpleRainyButton.classList.add('active');
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø—Ü–∏–π –≤ –∫—Ä—É–≥–ª–æ–º –º–µ–Ω—é
        function updateActiveThemeOptions(theme) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø—Ü–∏–∏ –≤ –∫—Ä—É–≥–ª–æ–º –º–µ–Ω—é
            circleThemeOptions.forEach(option => {
                option.classList.toggle('active', option.getAttribute('data-theme') === theme);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø—Ü–∏–∏ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –º–µ–Ω—é
            themeOptions.forEach(option => {
                option.classList.toggle('active', option.getAttribute('data-theme') === theme);
            });
        }
        
        console.log('== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π —Ç–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ==');
    });

    // –°–æ–∑–¥–∞–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –∑–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω
    document.addEventListener('DOMContentLoaded', () => {
        const enhancedStars = document.getElementById('enhanced-stars');
        if (enhancedStars) {
            // –°–æ–∑–¥–∞–µ–º –∑–≤–µ–∑–¥—ã
            for (let i = 0; i < 200; i++) {
                createStar();
            }
            
            // –°–æ–∑–¥–∞–µ–º –º–µ—Ç–µ–æ—Ä—ã
            setInterval(createMeteor, 10000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–≤–µ–∑–¥—ã
        function createStar() {
            const star = document.createElement('div');
            star.className = 'enhanced-star';
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
            const size = Math.random() * 3;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            
            // –°–ª—É—á–∞–π–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å –∏ –º–µ—Ä—Ü–∞–Ω–∏–µ
            const brightness = Math.random() * 0.8 + 0.2;
            star.style.opacity = brightness;
            star.style.animationDelay = `${Math.random() * 5}s`;
            star.style.animationDuration = `${Math.random() * 3 + 2}s`;
            
            enhancedStars.appendChild(star);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ç–µ–æ—Ä–∞
        function createMeteor() {
            const meteor = document.createElement('div');
            meteor.className = 'meteor';
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É –∏ —Å–ª–µ–≤–∞
            meteor.style.left = `${Math.random() * 80 + 10}%`;
            meteor.style.top = '0';
            
            // –°–ª—É—á–∞–π–Ω–∞—è –¥–ª–∏–Ω–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å
            const speed = Math.random() * 2 + 1;
            meteor.style.setProperty('--speed', `${speed}s`);
            
            enhancedStars.appendChild(meteor);
            
            // –£–¥–∞–ª—è–µ–º –º–µ—Ç–µ–æ—Ä –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                if (meteor.parentNode) {
                    meteor.parentNode.removeChild(meteor);
                }
            }, speed * 1000);
        }
    });

    document.addEventListener('DOMContentLoaded', function() {
        console.log('== DOMContentLoaded: –ù–ê–ß–ê–õ–û ==');
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ DOM-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        const rainyBackgroundCheck = document.getElementById('rainy-background');
        const enhancedStarsCheck = document.getElementById('enhanced-stars');
        const lightningContainerCheck = document.getElementById('lightning-container');
        
        console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ DOM-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:');
        console.log('- rainy-background:', rainyBackgroundCheck ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- enhanced-stars:', enhancedStarsCheck ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- lightning-container:', lightningContainerCheck ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        
        // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        window.rainyBackground = rainyBackgroundCheck;
        window.enhancedStars = enhancedStarsCheck;
        window.lightningContainer = lightningContainerCheck;
        
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞,
        // —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–æ –≤—Å–µ—Ö —á–∞—Å—Ç—è—Ö –∫–æ–¥–∞
        window.createRainyBackgroundGlobal = function() {
            console.log('–í—ã–∑–≤–∞–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è createRainyBackgroundGlobal');
            
            const rainyBg = document.getElementById('rainy-background');
            if (!rainyBg) {
                console.error('–≠–ª–µ–º–µ–Ω—Ç rainy-background –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            // –û—á–∏—â–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            rainyBg.innerHTML = '<div class="mist"></div>';
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Ñ–æ–Ω–∞
            rainyBg.style.background = 'linear-gradient(to bottom, #1c262b 0%, #37474f 40%, #455a64 100%)';
            
            // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏...
            const mist = rainyBg.querySelector('.mist');
            if (mist) {
                mist.style.background = 'linear-gradient(to bottom, rgba(192, 210, 222, 0.15) 0%, rgba(176, 198, 209, 0.25) 100%)';
                mist.style.opacity = '0.4';
            }
            
            // –°–æ–∑–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    createRaindrop(rainyBg);
                }, i * 100);
            }
            
            // –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞–ø–µ–ª—å
            const rainInterval = setInterval(() => {
                if (document.body.classList.contains('rainy-theme')) {
                    createRaindrop(rainyBg);
                } else {
                    clearInterval(rainInterval);
                }
            }, 100);
        };
        
        function createRaindrop(container) {
            const drop = document.createElement('div');
            drop.className = 'raindrop';
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
            drop.style.left = `${Math.random() * 100}%`;
            
            // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
            const duration = 0.5 + Math.random() * 1.5; // –æ—Ç 0.5 –¥–æ 2 —Å–µ–∫—É–Ω–¥—ã
            drop.style.setProperty('--duration', `${duration}s`);
            
            // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞—á–∞–ª–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
            drop.style.setProperty('--delay', `${Math.random() * 2}s`);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–ø–ª—é –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            container.appendChild(drop);
            
            // –°–æ–∑–¥–∞–µ–º –≤—Å–ø–ª–µ—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∫–∞–ø–ª–∏
            setTimeout(() => {
                const splash = document.createElement('div');
                splash.className = 'splash';
                splash.style.left = drop.style.left;
                splash.style.bottom = '0';
                container.appendChild(splash);
                
                // –£–¥–∞–ª—è–µ–º –≤—Å–ø–ª–µ—Å–∫ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    if (splash.parentNode) {
                        splash.parentNode.removeChild(splash);
                    }
                }, 600);
            }, (duration + parseFloat(drop.style.getPropertyValue('--delay'))) * 1000);
            
            // –£–¥–∞–ª—è–µ–º –∫–∞–ø–ª—é –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è
            setTimeout(() => {
                if (drop.parentNode) {
                    drop.parentNode.removeChild(drop);
                }
            }, (duration + parseFloat(drop.style.getPropertyValue('--delay')) + 1) * 1000);
        }
        
        console.log('== DOMContentLoaded: –ó–ê–í–ï–†–®–ï–ù–û ==');
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –±–æ–ª—å—à–æ–π –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É
        const bigRainyButton = document.getElementById('big-rainy-button');
        if (bigRainyButton) {
            console.log('–ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã –Ω–∞–π–¥–µ–Ω–∞, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫');
            
            bigRainyButton.addEventListener('click', function() {
                console.log('–ù–∞–∂–∞—Ç–∞ –ë–û–õ–¨–®–ê–Ø –∫–Ω–æ–ø–∫–∞ –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã');
                
                // –ù–∞–∏–±–æ–ª–µ–µ –ø—Ä—è–º–æ–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É
                try {
                    // 1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–ª–∞—Å—Å —Ç–µ–º—ã –Ω–∞ body
                    document.body.classList.add('rainy-theme');
                    document.body.classList.remove('cosmic-theme');
                    
                    // 2. –ù–∞—Ö–æ–¥–∏–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω
                    const rainyBg = document.getElementById('rainy-background');
                    if (rainyBg) {
                        rainyBg.style.display = 'block';
                        console.log('–î–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω –ø–æ–∫–∞–∑–∞–Ω');
                        
                        // 3. –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–∂–¥—è, –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç
                        if (!rainyBg.querySelector('.raindrop')) {
                            console.log('–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è');
                            
                            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Ç—É–º–∞–Ω–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                            if (!rainyBg.querySelector('.mist')) {
                                const mist = document.createElement('div');
                                mist.className = 'mist';
                                rainyBg.appendChild(mist);
                            }
                            
                            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
                            rainyBg.style.background = 'linear-gradient(to bottom, #1c262b 0%, #37474f 40%, #455a64 100%)';
                            
                            // –°–æ–∑–¥–∞–µ–º –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
                            for (let i = 0; i < 50; i++) {
                                const drop = document.createElement('div');
                                drop.className = 'raindrop';
                                drop.style.left = `${Math.random() * 100}%`;
                                drop.style.setProperty('--duration', `${0.5 + Math.random() * 1.5}s`);
                                drop.style.setProperty('--delay', `${Math.random() * 2}s`);
                                rainyBg.appendChild(drop);
                            }
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–ø–µ–ª—å
                            setInterval(function() {
                                if (document.body.classList.contains('rainy-theme')) {
                                    const drop = document.createElement('div');
                                    drop.className = 'raindrop';
                                    drop.style.left = `${Math.random() * 100}%`;
                                    drop.style.setProperty('--duration', `${0.5 + Math.random() * 1.5}s`);
                                    drop.style.setProperty('--delay', '0s');
                                    rainyBg.appendChild(drop);
                                    
                                    // –£–¥–∞–ª—è–µ–º –∫–∞–ø–ª—é –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                                    setTimeout(() => {
                                        if (drop.parentNode) {
                                            drop.parentNode.removeChild(drop);
                                        }
                                    }, 3000);
                                }
                            }, 100);
                        }
                    } else {
                        console.error('–≠–ª–µ–º–µ–Ω—Ç –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                    }
                    
                    // 4. –°–∫—Ä—ã–≤–∞–µ–º –∑–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω
                    const stars = document.getElementById('enhanced-stars');
                    if (stars) {
                        stars.style.display = 'none';
                        console.log('–ó–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω —Å–∫—Ä—ã—Ç');
                    }
                    
                    // 5. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                    localStorage.setItem('theme', 'rainy');
                    console.log('–¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage');
                    
                    // 6. –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
                    const simpleRainyBtn = document.getElementById('simple-rainy-button');
                    const simpleCosmicBtn = document.getElementById('simple-cosmic-button');
                    
                    if (simpleRainyBtn) simpleRainyBtn.classList.add('active');
                    if (simpleCosmicBtn) simpleCosmicBtn.classList.remove('active');
                    
                    console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!');
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                    bigRainyButton.style.display = 'none';
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É:', error);
                }
            });
        } else {
            console.error('–ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã –ù–ï –ù–ê–ô–î–ï–ù–ê!');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ç–µ–º
        const themeCircleToggle = document.getElementById('theme-circle-toggle');
        const themeCircleMenuItems = document.getElementById('theme-circle-menu-items');
        const themeOptions = document.querySelectorAll('.theme-option');
        
        if (themeCircleToggle && themeCircleMenuItems) {
            console.log('–ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏');
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—É–ª—å—Å–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            themeCircleToggle.classList.add('pulse');
            
            // –£–±–∏—Ä–∞–µ–º –ø—É–ª—å—Å–∞—Ü–∏—é —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                themeCircleToggle.classList.remove('pulse');
            }, 5000);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫—Ä—É–≥–ª—É—é –∫–Ω–æ–ø–∫—É (–æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é)
            themeCircleToggle.addEventListener('click', function(e) {
                e.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è
                themeCircleMenuItems.classList.toggle('active');
                console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–Ω—é —Ç–µ–º');
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (themeCircleMenuItems.classList.contains('active') && 
                    !themeCircleMenuItems.contains(e.target) && 
                    e.target !== themeCircleToggle) {
                    themeCircleMenuItems.classList.remove('active');
                    console.log('–ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é —Ç–µ–º (–∫–ª–∏–∫ –≤–Ω–µ)');
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—é
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    console.log(`–í—ã–±—Ä–∞–Ω–∞ —Ç–µ–º–∞ —á–µ—Ä–µ–∑ –∫—Ä—É–≥–ª–æ–µ –º–µ–Ω—é: ${theme}`);
                    
                    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç–µ–º—É –Ω–∞–ø—Ä—è–º—É—é
                    if (theme === 'cosmic') {
                        // –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞
                        document.body.classList.remove('rainy-theme');
                        document.body.classList.add('cosmic-theme');
                        
                        const rainyBg = document.getElementById('rainy-background');
                        const enhancedStars = document.getElementById('enhanced-stars');
                        
                        if (rainyBg) rainyBg.style.display = 'none';
                        if (enhancedStars) enhancedStars.style.display = 'block';
                        
                        // –£–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
                        const allDrops = document.querySelectorAll('.raindrop, .flowing-drop');
                        allDrops.forEach(drop => {
                            if (drop.parentNode) drop.parentNode.removeChild(drop);
                        });
                    } else if (theme === 'rainy') {
                        // –î–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞
                        document.body.classList.add('rainy-theme');
                        document.body.classList.remove('cosmic-theme');
                        
                        const rainyBg = document.getElementById('rainy-background');
                        const enhancedStars = document.getElementById('enhanced-stars');
                        
                        if (enhancedStars) enhancedStars.style.display = 'none';
                        
                        if (rainyBg) {
                            rainyBg.style.display = 'block';
                            
                            // –ï—Å–ª–∏ –∫–∞–ø–µ–ª—å –¥–æ–∂–¥—è –µ—â–µ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –∏—Ö
                            if (!rainyBg.querySelector('.raindrop')) {
                                console.log('–°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω —á–µ—Ä–µ–∑ –∫—Ä—É–≥–ª–æ–µ –º–µ–Ω—é');
                                
                                // –ü—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
                                if (typeof window.createRainyBackgroundGlobal === 'function') {
                                    window.createRainyBackgroundGlobal();
                                } else {
                                    console.warn('–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∂–¥—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥');
                                    
                                    // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∂–¥—è
                                    // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                                    rainyBg.innerHTML = '<div class="mist"></div>';
                                    
                                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω
                                    rainyBg.style.background = 'linear-gradient(to bottom, #1c262b 0%, #37474f 40%, #455a64 100%)';
                                    
                                    // –°–æ–∑–¥–∞–µ–º —Ç—É–º–∞–Ω
                                    const mist = rainyBg.querySelector('.mist');
                                    if (mist) {
                                        mist.style.background = 'linear-gradient(to bottom, rgba(192, 210, 222, 0.15) 0%, rgba(176, 198, 209, 0.25) 100%)';
                                        mist.style.opacity = '0.4';
                                    }
                                    
                                    // –°–æ–∑–¥–∞–µ–º –∫–∞–ø–ª–∏
                                    for (let i = 0; i < 50; i++) {
                                        const drop = document.createElement('div');
                                        drop.className = 'raindrop';
                                        drop.style.left = `${Math.random() * 100}%`;
                                        drop.style.setProperty('--duration', `${0.5 + Math.random() * 1.5}s`);
                                        drop.style.setProperty('--delay', `${Math.random() * 2}s`);
                                        rainyBg.appendChild(drop);
                                    }
                                    
                                    // –ò–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–ø–µ–ª—å
                                    const rainInterval = setInterval(() => {
                                        if (document.body.classList.contains('rainy-theme')) {
                                            const drop = document.createElement('div');
                                            drop.className = 'raindrop';
                                            drop.style.left = `${Math.random() * 100}%`;
                                            drop.style.setProperty('--duration', `${0.5 + Math.random() * 1.5}s`);
                                            drop.style.setProperty('--delay', '0s');
                                            rainyBg.appendChild(drop);
                                            
                                            // –£–¥–∞–ª—è–µ–º –∫–∞–ø–ª—é –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                                            setTimeout(() => {
                                                if (drop.parentNode) {
                                                    drop.parentNode.removeChild(drop);
                                                }
                                            }, 3000);
                                        } else {
                                            clearInterval(rainInterval);
                                        }
                                    }, 100);
                                }
                            }
                        } else {
                            console.error('–≠–ª–µ–º–µ–Ω—Ç –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                        }
                    }
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ localStorage
                    localStorage.setItem('theme', theme);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ —Ç–µ–º
                    const simpleCosmicBtn = document.getElementById('simple-cosmic-button');
                    const simpleRainyBtn = document.getElementById('simple-rainy-button');
                    
                    if (theme === 'cosmic') {
                        if (simpleCosmicBtn) simpleCosmicBtn.classList.add('active');
                        if (simpleRainyBtn) simpleRainyBtn.classList.remove('active');
                    } else {
                        if (simpleCosmicBtn) simpleCosmicBtn.classList.remove('active');
                        if (simpleRainyBtn) simpleRainyBtn.classList.add('active');
                    }
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é
                    themeCircleMenuItems.classList.remove('active');
                });
            });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–µ–º—É –≤ –º–µ–Ω—é
            const currentTheme = localStorage.getItem('theme') || 'cosmic';
            themeOptions.forEach(option => {
                if (option.getAttribute('data-theme') === currentTheme) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
        } else {
            console.error('–ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ç–µ–º –ù–ï –ù–ê–ô–î–ï–ù–û!');
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
        // –°–æ–∑–¥–∞–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –∑–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω
        function createEnhancedStarryBackground() {
            const container = document.getElementById('enhanced-stars');
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ä—Ü–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
            const starTypes = ['tiny', 'small', 'medium', 'large', 'bright'];
            const starCounts = [150, 100, 50, 25, 10]; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
            
            starTypes.forEach((type, index) => {
                for (let i = 0; i < starCounts[index]; i++) {
                    const star = document.createElement('div');
                    star.className = `star ${type}`;
                    
                    // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–≤–µ–∑–¥—ã –ø–æ —ç–∫—Ä–∞–Ω—É
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    
                    // –ù–∞–∑–Ω–∞—á–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    const duration = type === 'bright' ? 6 + Math.random() * 6 : 3 + Math.random() * 4;
                    star.style.setProperty('--duration', `${duration}s`);
                    star.style.setProperty('--delay', `${Math.random() * 5}s`);
                    
                    container.appendChild(star);
                }
            });
            
            // –°–æ–∑–¥–∞–µ–º —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            for (let i = 0; i < 4; i++) {
                const nebula = document.createElement('div');
                nebula.className = 'nebula';
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏ –ø–æ —ç–∫—Ä–∞–Ω—É
                nebula.style.left = `${Math.random() * 100}%`;
                nebula.style.top = `${Math.random() * 100}%`;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                nebula.style.setProperty('--delay', `${Math.random() * 10}s`);
                nebula.style.setProperty('--scale', `${1 + Math.random() * 1.5}`);
                
                // –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
                nebula.style.transform = `scale(var(--scale, 1)) rotate(${Math.random() * 360}deg)`;
                
                container.appendChild(nebula);
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ç–µ–æ—Ä–æ–≤
            function createMeteor() {
                const meteor = document.createElement('div');
                meteor.className = 'meteor';
                
                // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –º–µ—Ç–µ–æ—Ä–∞ (–≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞)
                const topPosition = Math.random() * 0.3; // 0-30% —Å–≤–µ—Ä—Ö—É
                const leftPosition = 0.1 + Math.random() * 0.8; // 10-90% —Å–ª–µ–≤–∞
                
                meteor.style.setProperty('--top', `${topPosition}`);
                meteor.style.setProperty('--left', `${leftPosition}`);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–µ–æ—Ä –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
                container.appendChild(meteor);
                
                // –£–¥–∞–ª—è–µ–º –º–µ—Ç–µ–æ—Ä –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    meteor.remove();
                }, 8000); // –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –º–µ—Ç–µ–æ—Ä–∞ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >= –≤—Ä–µ–º–µ–Ω–∏ –∞–Ω–∏–º–∞—Ü–∏–∏)
            }
            
            // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–µ–æ—Ä–æ–≤
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    createMeteor();
                }, i * 2000); // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            }
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –º–µ—Ç–µ–æ—Ä—ã
            setInterval(() => {
                createMeteor();
            }, 8000 + Math.random() * 5000); // –°–ª—É—á–∞–π–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –º–µ—Ç–µ–æ—Ä–∞–º–∏
        }
        
        // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å–æ–∑–¥–∞–Ω–∏—è –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞
        createEnhancedStarryBackground();
        
        // –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –≤—Å–µ—Ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function setTransparentBg() {
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
            let currentElement = document.querySelector('.main-content');
            
            // –ü–æ–∫–∞ –Ω–µ –¥–æ—à–ª–∏ –¥–æ body, –¥–µ–ª–∞–µ–º —Ñ–æ–Ω —Ä–æ–¥–∏—Ç–µ–ª–µ–π –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º
            while (currentElement && currentElement.parentElement) {
                currentElement = currentElement.parentElement;
                if (currentElement.tagName !== 'HTML') {
                    currentElement.style.backgroundColor = 'transparent';
                }
            }
        }
        
        // –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        setTransparentBg();
        
        // –ò —Ç–∞–∫–∂–µ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        window.addEventListener('scroll', setTransparentBg);
        
        const newsItems = document.querySelectorAll('.news-item');
        const skipButtons = document.querySelectorAll('.skip-button');
        const likeButtons = document.querySelectorAll('.like-button');
        const dislikeButtons = document.querySelectorAll('.dislike-button');
        const backButtons = document.querySelectorAll('.back-button');
        const commentButtons = document.querySelectorAll('.comment-button');
        const commentsModal = document.getElementById('comments-modal');
        const closeModal = document.querySelector('.close-modal');
        const commentsList = document.getElementById('comments-list');
        const commentForm = document.getElementById('comment-form');
        const commentText = document.getElementById('comment-text');
        const commentSubmit = document.getElementById('comment-submit');
        const commentError = document.getElementById('comment-error');
        const qrImage = document.getElementById('qr-image');
        const qrSource = document.getElementById('qr-source');
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ ID –Ω–æ–≤–æ—Å—Ç–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        let currentNewsId = null;
        
        // –ö–∞—Ä—Ç–∞ QR-–∫–æ–¥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        const qrCodeSources = {
            'cbr.ru': {
                url: "{% static 'Ad/images/Cbr.png' %}",
                name: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ë–∞–Ω–∫ –†–§",
                rainyUrl: "{% static 'Ad/images/cbrfrainy.png' %}"
            },
            'kommersant.ru': {
                url: "{% static 'Ad/images/kommersant.png' %}",
                name: "–ö–æ–º–º–µ—Ä—Å–∞–Ω—Ç",
                rainyUrl: "{% static 'Ad/images/kommersantrainy.png' %}"
            },
            'rambler.ru': {
                url: "{% static 'Ad/images/rembler.png' %}",
                name: "–†–∞–º–±–ª–µ—Ä",
                rainyUrl: "{% static 'Ad/images/ramblerrainy.png' %}"
            }
        };
        
        // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —à–∞–±–ª–æ–Ω–∞ Django
        const userAuthenticated = "{{ user.is_authenticated|yesno:'true,false' }}";
        const loginUrl = "{% url 'login' %}";

        let currentNewsIndex = 0;
        let timer;

        function showNews(index) {
            // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∏–Ω–¥–µ–∫—Å –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
            if (index < 0) {
                index = newsItems.length - 1;
            } else if (index >= newsItems.length) {
                index = 0;
            }
            currentNewsIndex = index;

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –∞–Ω–∏–º–∞—Ü–∏–∏
            const timerProgressCircles = document.querySelectorAll('.timer-circle-progress');
            timerProgressCircles.forEach(circle => {
                circle.style.animation = 'none';
                circle.offsetHeight;
                circle.style.animation = 'countdown 20s linear forwards';
            });

            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â—É—é
            newsItems.forEach((item, i) => {
                item.style.display = (i === index) ? 'block' : 'none';
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º QR-–∫–æ–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –Ω–æ–≤–æ—Å—Ç–∏
            updateQRCode(newsItems[index]);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Ç–µ–º—ã
            updateThemeElements();

            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π
            clearTimeout(timer);
            timer = setTimeout(() => {
                showNews((currentNewsIndex + 1) % newsItems.length);
            }, 20000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è QR-–∫–æ–¥–∞
        function updateQRCode(newsItem) {
            // –ü–æ–ª—É—á–∞–µ–º URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–∑ –∞—Ç—Ä–∏–±—É—Ç–∞ data-source-url
            const sourceUrl = newsItem.dataset.sourceUrl || '';
            
            // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¶–ë –†–§
            let qrCode = qrCodeSources['cbr.ru'];
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ URL
            if (sourceUrl.includes('cbr.ru') || sourceUrl.includes('centralbank')) {
                qrCode = qrCodeSources['cbr.ru'];
            } else if (sourceUrl.includes('kommersant.ru') || sourceUrl.includes('kommersant')) {
                qrCode = qrCodeSources['kommersant.ru'];
            } else if (sourceUrl.includes('rambler.ru') || sourceUrl.includes('rambler')) {
                qrCode = qrCodeSources['rambler.ru'];
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–µ–º—É
            const isRainyTheme = document.body.classList.contains('rainy-theme');
            const imageUrl = isRainyTheme && qrCode.rainyUrl ? qrCode.rainyUrl : qrCode.url;
            
            // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
            console.log('–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ–≤–æ—Å—Ç–∏:', sourceUrl);
            console.log('–í—ã–±—Ä–∞–Ω QR-–∫–æ–¥ –¥–ª—è:', qrCode.name);
            console.log('–î–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞:', isRainyTheme);
            console.log('–ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é QR-–∫–æ–¥–∞:', imageUrl);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é fadeout/fadein
            qrSource.style.opacity = '0';
            
            setTimeout(function() {
                // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ QR-–∫–æ–¥–∞
                const qrCodeImage = document.getElementById('qr-image');
                qrCodeImage.src = imageUrl;
                qrCodeImage.alt = qrCode.name;
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞
                qrSource.textContent = qrCode.name;
                qrSource.style.opacity = '1';
                
                // –î–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
                qrCodeImage.onload = function() {
                    console.log('QR-–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω:', imageUrl);
                };
                
                qrCodeImage.onerror = function() {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ QR-–∫–æ–¥–∞:', imageUrl);
                    console.log('–ü–æ–ª–Ω—ã–π URL –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ Django:', this.src);
                };
            }, 300);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫–∞–∑–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
        if (newsItems.length > 0) {
            showNews(currentNewsIndex);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
        document.addEventListener('themeChanged', function(e) {
            console.log('–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã, –æ–±–Ω–æ–≤–ª—è–µ–º QR-–∫–æ–¥...');
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –æ—Ç–∫—Ä—ã—Ç—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ–≤–æ—Å—Ç–∏
            const currentNewsItem = newsItems[currentNewsIndex];
            const currentSourceUrl = currentNewsItem.source_url;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º QR-–∫–æ–¥ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤–æ–π —Ç–µ–º–æ–π
            updateNewsQRCode(currentSourceUrl);
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        backButtons.forEach(button => {
            button.addEventListener('click', () => {
                showNews(currentNewsIndex - 1);

                // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
                fetch("/api/skip-news/", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCsrfToken(),
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({direction: 'back'})
                })
                .then(response => {
                    if (!response.ok) {
                        console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ${response.status}`);
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
                });
            });
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
        skipButtons.forEach(button => {
            button.addEventListener('click', () => {
                showNews(currentNewsIndex + 1);

                // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
                fetch("/api/skip-news/", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCsrfToken(),
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({direction: 'forward'})
                })
                .then(response => {
                    if (!response.ok) {
                        console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ${response.status}`);
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
                });
            });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ—Ü–µ–Ω–∫–∏
        function handleRatingClick(button, rating) {
            const newsId = button.dataset.newsId;
            const ratingType = button.dataset.rating;

            // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ü–µ–Ω–∫–∏
            fetch("/api/rate-news/", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCsrfToken(),
                    'Accept': 'application/json' // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –æ–∂–∏–¥–∞–µ–º JSON
                },
                body: JSON.stringify({
                    news_id: newsId,
                    rating_type: ratingType
                })
            })
            .then(response => {
                if (!response.ok) {
                    console.error(`HTTP –æ—à–∏–±–∫–∞! –°—Ç–∞—Ç—É—Å: ${response.status}`);
                    return response.text().then(text => {
                        console.error("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:", text);
                        throw new Error(`HTTP –æ—à–∏–±–∫–∞! –°—Ç–∞—Ç—É—Å: ${response.status}`);
                    });
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JSON
                const contentType = response.headers.get("content-type");
                if (!contentType || !contentType.includes("application/json")) {
                    return response.text().then(text => {
                        console.error("–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:", contentType);
                        console.error("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:", text);
                        throw new Error(`–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ: ${contentType}`);
                    });
                }
                
                return response.json();
            })
            .then(data => {
                console.log("–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:", data);
                if (data.status === 'success' || data.status === 'removed') {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –ª–∞–π–∫–æ–≤ –∏ –¥–∏–∑–ª–∞–π–∫–æ–≤
                    const newsItem = document.querySelector(`.news-item[data-id="${newsId}"]`);
                    const likeButton = newsItem.querySelector('.like-button');
                    const dislikeButton = newsItem.querySelector('.dislike-button');

                    likeButton.querySelector('.rating-count').textContent = data.likes;
                    dislikeButton.querySelector('.rating-count').textContent = data.dislikes;

                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫–Ω–æ–ø–æ–∫
                    if (data.status === 'success') {
                        if (ratingType === 'like') {
                            likeButton.classList.add('active');
                            dislikeButton.classList.remove('active');
                        } else {
                            dislikeButton.classList.add('active');
                            likeButton.classList.remove('active');
                        }
                    } else {
                        // –ï—Å–ª–∏ –æ—Ü–µ–Ω–∫–∞ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞
                        button.classList.remove('active');
                    }
                } else if (data.status === 'error') {
                    console.error('–û—à–∏–±–∫–∞:', data.message);
                    alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –Ω–æ–≤–æ—Å—Ç–∏: ${data.message}`);
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ü–µ–Ω–∫–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –≤—ã–∑–æ–≤–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
        function handleRatingButtonClick(button, ratingType) {
            if (userAuthenticated === "true") {
                handleRatingClick(button, ratingType);
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏.');
                window.location.href = loginUrl;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ª–∞–π–∫–æ–≤
        likeButtons.forEach(button => {
            button.addEventListener('click', () => handleRatingButtonClick(button, 'like'));
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–∏–∑–ª–∞–π–∫–æ–≤
        dislikeButtons.forEach(button => {
            button.addEventListener('click', () => handleRatingButtonClick(button, 'dislike'));
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –Ω–æ–≤–æ—Å—Ç–∏
        function loadComments(newsId) {
            commentsList.innerHTML = '<div class="no-comments">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤...</div>';
            
            fetch(`/api/comments/${newsId}/`, {
                headers: {
                    'Accept': 'application/json' // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –æ–∂–∏–¥–∞–µ–º JSON
                }
            })
                .then(response => {
                    if (!response.ok) {
                        return response.text().then(text => {
                            console.error(`HTTP –æ—à–∏–±–∫–∞! –°—Ç–∞—Ç—É—Å: ${response.status}`);
                            console.error("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:", text);
                            throw new Error(`HTTP –æ—à–∏–±–∫–∞! –°—Ç–∞—Ç—É—Å: ${response.status}`);
                        });
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JSON
                    const contentType = response.headers.get("content-type");
                    if (!contentType || !contentType.includes("application/json")) {
                        return response.text().then(text => {
                            console.error("–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:", contentType);
                            console.error("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:", text);
                            throw new Error(`–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ: ${contentType}`);
                        });
                    }
                    
                    return response.json();
                })
                .then(data => {
                    console.log("–û—Ç–≤–µ—Ç –æ—Ç API –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:", data);
                    if (data.status === 'success') {
                        const comments = data.comments;
                        
                        if (comments.length === 0) {
                            commentsList.innerHTML = '<div class="no-comments">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
                        } else {
                            commentsList.innerHTML = '';
                            comments.forEach(comment => {
                                const commentItem = document.createElement('div');
                                commentItem.className = 'comment-item';
                                commentItem.innerHTML = `
                                    <div class="comment-header">
                                        <span class="comment-username">${comment.username}</span>
                                        <span class="comment-date">${comment.created_at}</span>
                                    </div>
                                    <div class="comment-text">${comment.text}</div>
                                `;
                                commentsList.appendChild(commentItem);
                            });
                        }
                    } else {
                        commentsList.innerHTML = `<div class="error-message">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: ${data.message}</div>`;
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:', error);
                    commentsList.innerHTML = '<div class="error-message">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</div>';
                });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
        function addComment(newsId, commentText) {
            if (!commentText.trim()) {
                commentError.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è';
                commentError.style.display = 'block';
                return;
            }
            
            commentError.style.display = 'none';
            commentSubmit.disabled = true;
            
            fetch('/api/add-comment/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCsrfToken(),
                    'Accept': 'application/json' // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –æ–∂–∏–¥–∞–µ–º JSON
                },
                body: JSON.stringify({
                    news_id: newsId,
                    comment_text: commentText
                })
            })
            .then(response => {
                if (!response.ok) {
                    if (response.status === 401) {
                        throw new Error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.');
                    }
                    
                    return response.text().then(text => {
                        console.error(`HTTP –æ—à–∏–±–∫–∞! –°—Ç–∞—Ç—É—Å: ${response.status}`);
                        console.error("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:", text);
                        throw new Error(`HTTP –æ—à–∏–±–∫–∞! –°—Ç–∞—Ç—É—Å: ${response.status}`);
                    });
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JSON
                const contentType = response.headers.get("content-type");
                if (!contentType || !contentType.includes("application/json")) {
                    return response.text().then(text => {
                        console.error("–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:", contentType);
                        console.error("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:", text);
                        throw new Error(`–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ: ${contentType}`);
                    });
                }
                
                return response.json();
            })
            .then(data => {
                console.log("–û—Ç–≤–µ—Ç –æ—Ç API –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:", data);
                if (data.status === 'success') {
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    commentText.value = '';
                    
                    // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –æ—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤"
                    const noComments = commentsList.querySelector('.no-comments');
                    if (noComments) {
                        commentsList.innerHTML = '';
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞
                    const commentItem = document.createElement('div');
                    commentItem.className = 'comment-item';
                    commentItem.innerHTML = `
                        <div class="comment-header">
                            <span class="comment-username">${data.comment.username}</span>
                            <span class="comment-date">${data.comment.created_at}</span>
                        </div>
                        <div class="comment-text">${data.comment.text}</div>
                    `;
                    commentsList.insertBefore(commentItem, commentsList.firstChild);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –Ω–∞ –∫–Ω–æ–ø–∫–µ
                    const commentButton = document.querySelector(`.comment-button[data-news-id="${newsId}"]`);
                    const countElement = commentButton.querySelector('.rating-count');
                    const currentCount = parseInt(countElement.textContent) || 0;
                    countElement.textContent = currentCount + 1;
                    
                } else {
                    commentError.textContent = data.message;
                    commentError.style.display = 'block';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:', error);
                commentError.textContent = error.message;
                commentError.style.display = 'block';
            })
            .finally(() => {
                commentSubmit.disabled = false;
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        commentButtons.forEach(button => {
            button.addEventListener('click', () => {
                const newsId = button.dataset.newsId;
                currentNewsId = newsId;
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
                commentText.value = '';
                commentError.style.display = 'none';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è —Ñ–æ—Ä–º—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                if (userAuthenticated !== "true") {
                    commentForm.innerHTML = `
                        <div class="error-message">
                            –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="${loginUrl}">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.
                        </div>
                    `;
                } else {
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ä–º—É –µ—Å–ª–∏ –æ–Ω–∞ –±—ã–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∞
                    if (!commentText) {
                        commentForm.innerHTML = `
                            <div class="error-message" id="comment-error" style="display: none;"></div>
                            <textarea class="comment-textarea" id="comment-text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
                            <button class="comment-submit" id="comment-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        `;
                        commentText = document.getElementById('comment-text');
                        commentSubmit = document.getElementById('comment-submit');
                        commentError = document.getElementById('comment-error');
                    }
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                loadComments(newsId);
                
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                commentsModal.style.display = 'block';
            });
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
        commentSubmit.addEventListener('click', () => {
            if (currentNewsId) {
                addComment(currentNewsId, commentText.value);
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        closeModal.addEventListener('click', () => {
            commentsModal.style.display = 'none';
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –æ–±–ª–∞—Å—Ç–∏
        window.addEventListener('click', (event) => {
            if (event.target === commentsModal) {
                commentsModal.style.display = 'none';
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CSRF —Ç–æ–∫–µ–Ω–∞
        function getCsrfToken() {
            return document.cookie
                .split('; ')
                .find(row => row.startsWith('csrftoken='))
                ?.split('=')[1];
        }
        
        // ===== –ù–û–í–´–ô –ö–û–î –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –¢–ï–ú–ê–ú–ò =====
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º
        const themeToggle = document.getElementById('theme-toggle-button');
        const themeMenu = document.getElementById('theme-menu');
        const themeOptions = document.querySelectorAll('.theme-menu .theme-option');
        const rainyBackground = document.getElementById('rainy-background');
        const enhancedStars = document.getElementById('enhanced-stars');
        
        // –ü–æ–ª—É—á–∞–µ–º –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–ø—Ü–∏–∏ —Ç–µ–º
        const cosmicThemeOption = document.querySelector('.theme-option.cosmic-theme');
        const rainyThemeOption = document.querySelector('.theme-option.rainy-theme');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const savedTheme = localStorage.getItem('theme') || 'cosmic';
        setTheme(savedTheme);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ DOM
        console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ DOM:');
        console.log('- themeToggle:', themeToggle ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- themeMenu:', themeMenu ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- cosmicThemeOption:', cosmicThemeOption ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- rainyThemeOption:', rainyThemeOption ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- rainyBackground:', rainyBackground ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- enhancedStars:', enhancedStars ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é —Ç–µ–º –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∏–∫–æ–Ω–∫—É
        themeToggle.addEventListener('click', () => {
            console.log('–ö–ª–∏–∫ –ø–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—é —Ç–µ–º');
            themeMenu.classList.toggle('visible');
            console.log('–ú–µ–Ω—é —Ç–µ–º –≤–∏–¥–∏–º–æ:', themeMenu.classList.contains('visible'));
        });
        
        // –ê–≤–∞—Ä–∏–π–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Ç–µ–º—ã –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º –∫–ª–∏–∫–µ
        themeToggle.addEventListener('dblclick', () => {
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ—Å–º–∏—á–µ—Å–∫—É—é —Ç–µ–º—É
            document.body.classList.remove('rainy-theme');
            rainyBackground.style.display = 'none';
            enhancedStars.style.display = 'block';
            localStorage.setItem('theme', 'cosmic');
            
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–∞–ø–ª–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –∫–æ—Å–º–∏—á–µ—Å–∫—É—é —Ç–µ–º—É
            removeAllDrops();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –æ–ø—Ü–∏—é –≤ –º–µ–Ω—é
            themeOptions.forEach(option => {
                if (option.dataset.theme === 'cosmic') {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateThemeElements();
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ
            themeMenu.classList.remove('visible');
            
            console.log('–ê–í–ê–†–ò–ô–ù–´–ô –°–ë–†–û–°: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞');
        });
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.addEventListener('click', (event) => {
            if (!themeToggle.contains(event.target) && !themeMenu.contains(event.target)) {
                themeMenu.classList.remove('visible');
            }
        });
        
        // –ü—Ä—è–º—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–µ–º
        cosmicThemeOption.addEventListener('click', () => {
            console.log('–ö–ª–∏–∫ –Ω–∞ –∫–æ—Å–º–∏—á–µ—Å–∫—É—é —Ç–µ–º—É');
            setTheme('cosmic');
            themeMenu.classList.remove('visible');
        });
        
        rainyThemeOption.addEventListener('click', () => {
            console.log('–ö–ª–∏–∫ –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É');
            try {
            setTheme('rainy');
                console.log('–¢–µ–º–∞ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É:', error);
            }
            themeMenu.classList.remove('visible');
        });
        
        // –û–±—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
        themeOptions.forEach(option => {
            option.addEventListener('click', () => {
                const theme = option.dataset.theme;
                setTheme(theme);
                themeMenu.classList.remove('visible');
            });
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–º—ã
        function setTheme(theme) {
            console.log('–í—ã–∑–æ–≤ setTheme —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º:', theme);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç—ã–µ –∫–Ω–æ–ø–∫–∏ —Ç–æ–∂–µ
            try {
                const simpleCosmicBtn = document.getElementById('simple-cosmic-button');
                const simpleRainyBtn = document.getElementById('simple-rainy-button');
                
                if (theme === 'cosmic' && simpleCosmicBtn && simpleRainyBtn) {
                    simpleCosmicBtn.classList.add('active');
                    simpleRainyBtn.classList.remove('active');
                } else if (theme === 'rainy' && simpleCosmicBtn && simpleRainyBtn) {
                    simpleRainyBtn.classList.add('active');
                    simpleCosmicBtn.classList.remove('active');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∫–Ω–æ–ø–æ–∫:', error);
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            if (!rainyBackground) {
                console.error('–û—à–∏–±–∫–∞: —ç–ª–µ–º–µ–Ω—Ç rainyBackground –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                rainyBackground = document.getElementById('rainy-background');
                if (!rainyBackground) {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç —Å id="rainy-background"');
                    return;
                }
            }
            
            if (!enhancedStars) {
                console.error('–û—à–∏–±–∫–∞: —ç–ª–µ–º–µ–Ω—Ç enhancedStars –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                enhancedStars = document.getElementById('enhanced-stars');
                if (!enhancedStars) {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç —Å id="enhanced-stars"');
                    return;
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            localStorage.setItem('theme', theme);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –æ–ø—Ü–∏—é –≤ –º–µ–Ω—é
            themeOptions.forEach(option => {
                if (option.dataset.theme === theme) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é removeAllDrops –µ—Å–ª–∏ –æ–Ω–∞ –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ
            if (typeof window.removeAllDrops !== 'function') {
                window.removeAllDrops = function() {
                    console.log('–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–∞–ø–µ–ª—å...');
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ flowing-drop
                    const allFlowingDrops = document.querySelectorAll('.flowing-drop');
                    allFlowingDrops.forEach(drop => {
                        if (drop.parentNode) {
                            drop.parentNode.removeChild(drop);
                        }
                    });
                };
            }
            
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–∞–ø–ª–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ–º—ã
            try {
                window.removeAllDrops();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞–ø–µ–ª—å:', error);
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–ª–Ω–∏–π –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
            if (lightningInterval) {
                clearInterval(lightningInterval);
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –∫ body
            if (theme === 'rainy') {
                console.log('–ü—Ä–∏–º–µ–Ω—è–µ–º –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É...');
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã
                document.body.classList.add('rainy-theme');
                document.body.classList.remove('cosmic-theme');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ–Ω—ã
                if (rainyBackground) {
                rainyBackground.style.display = 'block';
                    console.log('–î–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
                } else {
                    console.error('rainyBackground –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω!');
                }
                
                if (enhancedStars) {
                enhancedStars.style.display = 'none';
                    console.log('–ó–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω —Å–∫—Ä—ã—Ç');
                } else {
                    console.error('enhancedStars –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω!');
                }
                
                // –°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–∞–ø–µ–ª—å –¥–æ–∂–¥—è...');
                try {
                    if (rainyBackground && !rainyBackground.querySelector('.raindrop')) {
                        console.log('–ö–∞–ø–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, —Å–æ–∑–¥–∞—ë–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω');
                    createRainyBackground();
                }
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç –º–æ–ª–Ω–∏–π
                    if (typeof startLightningEffects === 'function') {
                        console.log('–ó–∞–ø—É—Å–∫–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç –º–æ–ª–Ω–∏–π');
                        startLightningEffects();
            } else {
                        console.error('–§—É–Ω–∫—Ü–∏—è startLightningEffects –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞:', error);
                }
            } else {
                console.log('–ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ—Å–º–∏—á–µ—Å–∫—É—é —Ç–µ–º—É...');
                // –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
                document.body.classList.remove('rainy-theme');
                document.body.classList.add('cosmic-theme');
                
                if (rainyBackground) {
                rainyBackground.style.display = 'none';
                }
                
                if (enhancedStars) {
                enhancedStars.style.display = 'block';
                }
            }
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            updateThemeElements();
            
            console.log('–¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞:', theme);
        }
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã
        function updateThemeElements() {
            const newsItems = document.querySelectorAll('.news-item');
            const timers = document.querySelectorAll('.timer-container');
            const newsControls = document.querySelectorAll('.news-controls');
            
            // –£–±–µ–¥–∏–º—Å—è —á—Ç–æ –≤—Å–µ —Ç–∞–π–º–µ—Ä—ã –≤–∏–¥–∏–º—ã
            timers.forEach(timer => {
                timer.style.opacity = '1';
                timer.style.visibility = 'visible';
            });
            
            // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–∏–º—ã
            newsControls.forEach(control => {
                control.style.opacity = '1';
                control.style.visibility = 'visible';
            });
            
            // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ç–µ–∫—É—â–∞—è –Ω–æ–≤–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
            if (newsItems.length > 0 && currentNewsIndex < newsItems.length) {
                newsItems[currentNewsIndex].style.display = 'block';
            }
            
            // –û–±–Ω–æ–≤–∏–º –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å QR-—Å–µ–∫—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
            const qrSection = document.querySelector('.qr-section');
            if (qrSection) {
                if (document.body.classList.contains('rainy-theme')) {
                    qrSection.style.backgroundColor = 'rgba(245, 250, 255, 0.1)';
                    qrSection.style.backdropFilter = 'blur(5px)';
                } else {
                    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–ª—è –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Ç–µ–º—ã
                    qrSection.style.backgroundColor = '';
                    qrSection.style.backdropFilter = '';
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞
        function createRainyBackground() {
            const container = rainyBackground;
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            // –ú–µ–Ω—è–µ–º —Ñ–æ–Ω –Ω–∞ –±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
            container.style.background = 'linear-gradient(to bottom, #1c262b 0%, #37474f 40%, #455a64 100%)';
            
            // –£—Å–∏–ª–∏–≤–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç –¥—ã–º–∫–∏ –¥–ª—è –±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤–∏–¥–∞
            const mist = container.querySelector('.mist');
            if (mist) {
                mist.style.background = 'linear-gradient(to bottom, rgba(192, 210, 222, 0.15) 0%, rgba(176, 198, 209, 0.25) 100%)';
                mist.style.opacity = '0.4';
            }
            
            // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞–ø–µ–ª—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            const body = document.body;
            
            // –£–¥–∞–ª—è–µ–º –ª—é–±—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞–ø–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –æ—Å—Ç–∞—Ç—å—Å—è –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π —Ç–µ–º
            function removeAllDrops() {
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ flowing-drop
                const allFlowingDrops = document.querySelectorAll('.flowing-drop');
                allFlowingDrops.forEach(drop => {
                    if (drop.parentNode) {
                        drop.parentNode.removeChild(drop);
                    }
                });
            }
            
            // –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ–º –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–∞–ø–ª–∏
            removeAllDrops();
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–µ–∫–∞—é—â–∏—Ö –∫–∞–ø–µ–ª—å
            function createFlowingDrops() {
                // –ï—Å–ª–∏ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞, –Ω–µ —Å–æ–∑–¥–∞–µ–º –∫–∞–ø–ª–∏
                if (!document.body.classList.contains('rainy-theme')) {
                    return;
                }
                
                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–µ–∫–∞—é—â–∏—Ö –∫–∞–ø–µ–ª—å - —É–≤–µ–ª–∏—á–µ–Ω–æ
                const MAX_FLOWING_DROPS = 30;
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∫–∞–ø–ª–∏ –µ—Å–ª–∏ –∏—Ö —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ
                const currentDrops = document.querySelectorAll('.flowing-drop');
                if (currentDrops.length > MAX_FLOWING_DROPS) {
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å—Ç–µ–∫–∞—é—â—É—é –∫–∞–ø–ª—é
                const drop = document.createElement('div');
                drop.className = 'flowing-drop';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é (–≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞)
                const startPosX = 5 + Math.random() * 90; // 5-95% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞
                drop.style.left = `${startPosX}%`;
                drop.style.top = `${Math.random() * 20}%`; // –ù–∞—á–∏–Ω–∞–µ–º –≤ –≤–µ—Ä—Ö–Ω–∏—Ö 20% —ç–∫—Ä–∞–Ω–∞
                
                // –ó–∞–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
                const width = 2 + Math.random() * 4; // 2-6px —à–∏—Ä–∏–Ω–∞
                const height = 10 + Math.random() * 20; // 10-30px –≤—ã—Å–æ—Ç–∞
                drop.style.setProperty('--width', `${width}px`);
                drop.style.setProperty('--height', `${height}px`);
                
                // –ó–∞–¥–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø—É—Ç—å —Å—Ç–µ–∫–∞–Ω–∏—è
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
                const windowHeight = window.innerHeight;
                const y1 = 50 + Math.random() * 50;
                const y2 = y1 + 50 + Math.random() * 50;
                const y3 = y2 + 50 + Math.random() * 50;
                const y4 = y3 + 50 + Math.random() * 50;
                const y5 = Math.min(y4 + 100 + Math.random() * 100, windowHeight);
                
                const x1 = -10 + Math.random() * 20;
                const x2 = -10 + Math.random() * 20;
                const x3 = -10 + Math.random() * 20;
                const x4 = -10 + Math.random() * 20;
                const x5 = -10 + Math.random() * 20;
                
                drop.style.setProperty('--y1', `${y1}px`);
                drop.style.setProperty('--y2', `${y2}px`);
                drop.style.setProperty('--y3', `${y3}px`);
                drop.style.setProperty('--y4', `${y4}px`);
                drop.style.setProperty('--y5', `${y5}px`);
                
                drop.style.setProperty('--x1', `${x1}px`);
                drop.style.setProperty('--x2', `${x2}px`);
                drop.style.setProperty('--x3', `${x3}px`);
                drop.style.setProperty('--x4', `${x4}px`);
                drop.style.setProperty('--x5', `${x5}px`);
                
                // –°–ª—É—á–∞–π–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∑–∞–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
                const duration = 4 + Math.random() * 8; // 4-12 —Å–µ–∫—É–Ω–¥
                drop.style.setProperty('--duration', `${duration}s`);
                drop.style.setProperty('--delay', `${Math.random() * 2}s`);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–ø–ª—é –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞, –∞ –Ω–µ –≤ body
                container.appendChild(drop);
                
                // –£–¥–∞–ª—è–µ–º –∫–∞–ø–ª—é –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    if (drop.parentNode) {
                        drop.parentNode.removeChild(drop);
                    }
                }, (duration + 2) * 1000); // –î–æ–±–∞–≤–ª—è–µ–º 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏
            }
            
            // –°–æ–∑–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Å—Ç–µ–∫–∞—é—â–∏–µ –∫–∞–ø–ª–∏ - —É–≤–µ–ª–∏—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createFlowingDrops();
                }, i * 300); // —Å–æ–∑–¥–∞–µ–º —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 300–º—Å –¥–ª—è –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–æ—Ç—ã
            }
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å—Ç–µ–∫–∞—é—â–∏–µ –∫–∞–ø–ª–∏
            const flowingDropInterval = setInterval(() => {
                if (document.body.classList.contains('rainy-theme')) {
                    createFlowingDrops();
                    createFlowingDrops(); // –î–æ–±–∞–≤–ª—è–µ–º –¥–≤–µ –∫–∞–ø–ª–∏ –∑–∞ —Ä–∞–∑ –¥–ª—è –±–æ–ª—å—à–µ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
                } else {
                    // –ï—Å–ª–∏ —Ç–µ–º–∞ –Ω–µ –¥–æ–∂–¥–ª–∏–≤–∞—è, —É–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–µ–∫–∞—é—â–∏–µ –∫–∞–ø–ª–∏
                    removeAllDrops();
                    clearInterval(flowingDropInterval);
                }
            }, 800); // –∫–∞–∂–¥—ã–µ 800–º—Å
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –º–æ–ª–Ω–∏–∏
            function createLightningEffect() {
                const lightningContainer = document.getElementById('lightning-container');
                const thunderSound = document.getElementById('thunder-sound');
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –º–æ–ª–Ω–∏–∏ (—Ñ–æ–Ω–æ–≤–∞—è –≤—Å–ø—ã—à–∫–∞)
                const lightning = document.createElement('div');
                lightning.className = 'lightning';
                lightningContainer.appendChild(lightning);
                
                // –°–æ–∑–¥–∞–µ–º —Ç–æ–Ω–∫—É—é –ª–∏–Ω–∏—é –º–æ–ª–Ω–∏–∏ (–∑–∏–≥–∑–∞–≥–æ–æ–±—Ä–∞–∑–Ω—É—é)
                const bolt = document.createElement('div');
                bolt.className = 'lightning-bolt';
                
                // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                const startLeftPos = 10 + Math.random() * 80; // –æ—Ç 10% –¥–æ 90% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞
                bolt.style.left = `${startLeftPos}%`;
                
                // –°–ª—É—á–∞–π–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∏ —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞
                const boltHeight = 100 + Math.random() * 500; // –æ—Ç 100px –¥–æ 600px
                const rotateAngle = -5 + Math.random() * 10; // –æ—Ç -5 –¥–æ 5 –≥—Ä–∞–¥—É—Å–æ–≤
                
                bolt.style.setProperty('--bolt-height', `${boltHeight}px`);
                bolt.style.setProperty('--bolt-rotate', `${rotateAngle}deg`);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –±–æ–ª—Ç–∞ –º–æ–ª–Ω–∏–∏
                bolt.style.animation = 'lightning-bolt-appear 0.5s linear forwards';
                
                lightningContainer.appendChild(bolt);
                
                // –°–æ–∑–¥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏–π –æ—Ç –≥–ª–∞–≤–Ω–æ–π –ª–∏–Ω–∏–∏ –º–æ–ª–Ω–∏–∏
                const branchCount = 1 + Math.floor(Math.random() * 3); // 1-3 –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è
                
                for (let i = 0; i < branchCount; i++) {
                    // –°–æ–∑–¥–∞–µ–º –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏–µ
                    const branch = document.createElement('div');
                    branch.className = 'lightning-bolt';
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ–ª—Ç–∞
                    const branchPos = 20 + Math.random() * 60; // –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ø–æ –≤—ã—Å–æ—Ç–µ –±–æ–ª—Ç–∞ (20-80%)
                    const branchY = boltHeight * (branchPos / 100);
                    const branchRotate = 20 + Math.random() * 40; // —É–≥–æ–ª –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è (20-60 –≥—Ä–∞–¥—É—Å–æ–≤)
                    const branchWidth = 50 + Math.random() * 150; // –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è
                    branch.style.left = `${startLeftPos}%`;
                    branch.style.top = `${branchY}px`;
                    branch.style.width = '2px';
                    branch.style.height = '2px';
                    branch.style.setProperty('--branch-y', `${branchY}px`);
                    branch.style.setProperty('--branch-rotate', `${Math.random() > 0.5 ? branchRotate : -branchRotate}deg`);
                    branch.style.setProperty('--branch-width', `${branchWidth}px`);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è
                    branch.style.animation = `lightning-branch-appear ${0.3 + Math.random() * 0.2}s linear forwards`;
                    branch.style.animationDelay = `${0.1 + Math.random() * 0.2}s`;
                    
                    lightningContainer.appendChild(branch);
                    
                    // –£–¥–∞–ª—è–µ–º –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                    setTimeout(() => {
                        if (branch.parentNode) {
                            branch.parentNode.removeChild(branch);
                        }
                    }, 600);
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –≤—Å–ø—ã—à–∫–∏
                setTimeout(() => {
                    lightning.style.animation = 'none';
                    lightning.offsetHeight; // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
                    lightning.style.animation = 'lightning-flash 0.3s linear';
                    
                    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ –≥—Ä–æ–º–∞, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
                    if (thunderSound) {
                        setTimeout(() => {
                            thunderSound.currentTime = 0;
                            thunderSound.play().catch(e => console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫ –≥—Ä–æ–º–∞:', e));
                        }, 300);
                    }
                }, 100);
                
                // –£–¥–∞–ª—è–µ–º –º–æ–ª–Ω–∏—é –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    if (lightning.parentNode) {
                        lightning.parentNode.removeChild(lightning);
                    }
                    if (bolt.parentNode) {
                        bolt.parentNode.removeChild(bolt);
                    }
                }, 600);
            }
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º –º–æ–ª–Ω–∏–∏
            function scheduleLightning() {
                if (!document.body.classList.contains('rainy-theme')) {
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º –º–æ–ª–Ω–∏—é
                createLightningEffect();
                
                // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â—É—é –º–æ–ª–Ω–∏—é —Å–æ —Å–ª—É—á–∞–π–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
                const nextLightningDelay = 5000 + Math.random() * 25000; // –û—Ç 5 –¥–æ 30 —Å–µ–∫—É–Ω–¥
                setTimeout(scheduleLightning, nextLightningDelay);
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –º–æ–ª–Ω–∏–π
            setTimeout(scheduleLightning, 5000);
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è —Å –∑–∞–º—ã–∫–∞–Ω–∏–µ–º –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–º–∏
            const createRaindrops = (() => {
                const MAX_DROPS = 200;
                const drops = [];
                
                return function() {
                    // –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–∞–ø–µ–ª—å, —É–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ
                    while (drops.length > MAX_DROPS) {
                        const oldDrop = drops.shift();
                        if (oldDrop && oldDrop.parentNode) {
                            oldDrop.parentNode.removeChild(oldDrop);
                        }
                    }
                    
                    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –∫–∞–ø–ª–∏
                    for (let i = 0; i < 10; i++) {
                        const drop = document.createElement('div');
                        drop.className = 'raindrop';
                        
                        // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
                        drop.style.left = `${Math.random() * 100}%`;
                        
                        // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
                        const duration = 0.7 + Math.random() * 0.7;
                        drop.style.setProperty('--duration', `${duration}s`);
                        drop.style.setProperty('--delay', `${Math.random() * 0.5}s`);
                        
                        // –°–ª—É—á–∞–π–Ω–∞—è –¥–ª–∏–Ω–∞ –∏ —à–∏—Ä–∏–Ω–∞ –∫–∞–ø–ª–∏ –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
                        drop.style.height = `${10 + Math.random() * 15}px`;
                        drop.style.width = `${1 + Math.random() * 1.5}px`;
                        
                        // –°–ª—É—á–∞–π–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª—É–±–∏–Ω—ã
                        drop.style.opacity = `${0.3 + Math.random() * 0.7}`;
                        
                        container.appendChild(drop);
                        drops.push(drop);
                        
                        // –°–æ–∑–¥–∞–µ–º –±—Ä—ã–∑–≥–∏ –∫–æ–≥–¥–∞ –∫–∞–ø–ª—è –¥–æ—Å—Ç–∏–≥–∞–µ—Ç "–∑–µ–º–ª–∏"
                        setTimeout(() => {
                            if (document.body.classList.contains('rainy-theme')) {
                                const splash = document.createElement('div');
                                splash.className = 'splash';
                                splash.style.left = drop.style.left;
                                splash.style.top = `${windowHeight - 5}px`;
                                container.appendChild(splash);
                                
                                // –£–¥–∞–ª—è–µ–º –±—Ä—ã–∑–≥–∏ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                                setTimeout(() => {
                                    if (splash.parentNode) {
                                        splash.parentNode.removeChild(splash);
                                    }
                                }, 600);
                            }
                        }, duration * 1000);
                    }
                };
            })();
            
            // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–µ –∫–∞–ø–ª–∏
            createRaindrops();

            // –î–æ–±–∞–≤–ª—è–µ–º –ª–µ–≥–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç —Ç—É–º–∞–Ω–∞ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
            const bottomMist = document.createElement('div');
            bottomMist.className = 'bottom-mist';
            bottomMist.style.position = 'absolute';
            bottomMist.style.bottom = '0';
            bottomMist.style.left = '0';
            bottomMist.style.width = '100%';
            bottomMist.style.height = '150px';
            bottomMist.style.background = 'linear-gradient(to top, rgba(192, 210, 222, 0.2) 0%, rgba(176, 198, 209, 0) 100%)';
            bottomMist.style.pointerEvents = 'none';
            container.appendChild(bottomMist);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –º–æ–ª–Ω–∏–∏ –¥–ª—è –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã
            let lightningInterval;
            
            function startLightningEffects() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –¥–æ–∂–¥–ª–∏–≤—ã–π —Ä–µ–∂–∏–º
                if (!document.body.classList.contains('rainy-theme')) {
                    return;
                }
                
                // –ü–µ—Ä–≤–∞—è –º–æ–ª–Ω–∏—è —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
                setTimeout(() => {
                    createLightningEffect();
                }, 2000);
                
                // –°–æ–∑–¥–∞–µ–º –º–æ–ª–Ω–∏–∏ —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏
                lightningInterval = setInterval(() => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –µ—â–µ –¥–æ–∂–¥–ª–∏–≤—ã–π —Ä–µ–∂–∏–º
                    if (!document.body.classList.contains('rainy-theme')) {
                        clearInterval(lightningInterval);
                        return;
                    }
                    
                    // –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º–æ–ª–Ω–∏–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ 75%)
                    if (Math.random() > 0.25) {
                        createLightningEffect();
                    }
                }, 8000 + Math.random() * 15000); // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç 8 –¥–æ 23 —Å–µ–∫—É–Ω–¥
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ–ª–Ω–∏–∏ –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞
            if (document.body.classList.contains('rainy-theme')) {
                startLightningEffects();
            }
            
            // –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–∞–ø–ª–∏
            const rainInterval = setInterval(() => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –¥–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞
                if (document.body.classList.contains('rainy-theme')) {
                    createRaindrops();
                } else {
                    // –ï—Å–ª–∏ —Ç–µ–º–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞, –º–æ–∂–Ω–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–ø–µ–ª—å
                    clearInterval(rainInterval);
                }
            }, 100);
        }
        
        // –î–æ–±–∞–≤–∏–º –ø—Ä—è–º–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        try {
            const directRainyOption = document.querySelector('.theme-option.rainy-theme');
            if (directRainyOption) {
                console.log('–î–æ–±–∞–≤–ª—è–µ–º –ø—Ä—è–º–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ onclick –¥–ª—è –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã');
                directRainyOption.onclick = function() {
                    console.log('–ü—Ä—è–º–æ–π –∫–ª–∏–∫ –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É');
                    try {
                        setTheme('rainy');
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –≤ –ø—Ä—è–º–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ:', error);
                    }
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é
                    const menu = document.getElementById('theme-menu');
                    if (menu) menu.classList.remove('visible');
                    
                    return false; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è
                };
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä—è–º–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:', error);
        }
        
        // –°–æ–∑–¥–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –¥–æ–∂–¥–ª–∏–≤—É—é —Ç–µ–º—É
        try {
            const emergencyButton = document.createElement('button');
            emergencyButton.textContent = '–î–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞';
            emergencyButton.style.position = 'fixed';
            emergencyButton.style.bottom = '10px';
            emergencyButton.style.left = '10px';
            emergencyButton.style.zIndex = '9999';
            emergencyButton.style.padding = '5px 10px';
            emergencyButton.style.backgroundColor = '#546e7a';
            emergencyButton.style.color = 'white';
            emergencyButton.style.border = 'none';
            emergencyButton.style.borderRadius = '5px';
            emergencyButton.style.cursor = 'pointer';
            
            emergencyButton.onclick = function() {
                console.log('–ù–∞–∂–∞—Ç–∞ –∞–≤–∞—Ä–∏–π–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–æ–∂–¥–ª–∏–≤–æ–π —Ç–µ–º—ã');
                setTheme('rainy');
            };
            
            document.body.appendChild(emergencyButton);
            console.log('–ê–≤–∞—Ä–∏–π–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≤–∞—Ä–∏–π–Ω–æ–π –∫–Ω–æ–ø–∫–∏:', error);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º
        const simpleCosmicButton = document.getElementById('simple-cosmic-button');
        const simpleRainyButton = document.getElementById('simple-rainy-button');
        
        if (simpleCosmicButton) {
            simpleCosmicButton.addEventListener('click', function() {
                console.log('–ù–∞–∂–∞—Ç–∞ –ø—Ä–æ—Å—Ç–∞—è –∫–Ω–æ–ø–∫–∞: –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞');
                
                // –ü—Ä—è–º–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏
                document.body.classList.remove('rainy-theme');
                document.body.classList.add('cosmic-theme');
                
                if (rainyBackground) rainyBackground.style.display = 'none';
                if (enhancedStars) enhancedStars.style.display = 'block';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä
                localStorage.setItem('theme', 'cosmic');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
                simpleCosmicButton.classList.add('active');
                simpleRainyButton.classList.remove('active');
                
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–∞–ø–ª–∏
                const allFlowingDrops = document.querySelectorAll('.flowing-drop');
                allFlowingDrops.forEach(drop => {
                    if (drop.parentNode) drop.parentNode.removeChild(drop);
                });
                
                console.log('–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞');
            });
        }
        
        if (simpleRainyButton) {
            simpleRainyButton.addEventListener('click', function() {
                console.log('–ù–∞–∂–∞—Ç–∞ –ø—Ä–æ—Å—Ç–∞—è –∫–Ω–æ–ø–∫–∞: –î–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞');
                
                // –ü—Ä—è–º–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏
                document.body.classList.add('rainy-theme');
                document.body.classList.remove('cosmic-theme');
                
                const rainyBg = document.getElementById('rainy-background');
                const enhancedStrs = document.getElementById('enhanced-stars');
                
                if (rainyBg) {
                    rainyBg.style.display = 'block';
                    
                    // –°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                    if (!rainyBg.querySelector('.raindrop')) {
                        console.log('–°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é');
                        try {
                            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
                            if (typeof window.createRainyBackgroundGlobal === 'function') {
                                window.createRainyBackgroundGlobal();
                            } else {
                                console.error('–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è createRainyBackgroundGlobal –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                                // –ü—Ä–æ–±—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                                if (typeof createRainyBackground === 'function') {
                                    createRainyBackground();
                                } else {
                                    console.error('–§—É–Ω–∫—Ü–∏—è createRainyBackground —Ç–æ–∂–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                                }
                            }
                        } catch (error) {
                            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞:', error);
                        }
                    }
                } else {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç rainy-background');
                }
                
                if (enhancedStrs) {
                    enhancedStrs.style.display = 'none';
                } else {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç enhanced-stars');
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä
                localStorage.setItem('theme', 'rainy');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
                const simpleCosmicBtn = document.getElementById('simple-cosmic-button');
                if (simpleCosmicBtn) simpleCosmicBtn.classList.remove('active');
                simpleRainyButton.classList.add('active');
                
                console.log('–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –¥–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞');
            });
        }
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
        const currentTheme = localStorage.getItem('theme') || 'cosmic';
        if (currentTheme === 'cosmic') {
            simpleCosmicButton?.classList.add('active');
        } else {
            simpleRainyButton?.classList.add('active');
        }
    });

    // –ö–æ–¥ –¥–ª—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOMContentLoaded: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é —Ç–µ–º');
        
        /*
         * –í–ù–ò–ú–ê–ù–ò–ï: –í—Å–µ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã.
         * –ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é (theme-circle-menu) - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π
         * —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–µ–º–∞–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.
         */
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM-—Å—Ç—Ä—É–∫—Ç—É—Ä—É
        const rainyBackground = document.getElementById('rainy-background');
        const enhancedStars = document.getElementById('enhanced-stars');
        
        console.log('–≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ–Ω–∞:');
        console.log('- rainy-background:', rainyBackground ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        console.log('- enhanced-stars:', enhancedStars ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù');
        
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞
        window.createRainyBackground = function() {
            console.log('–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∂–¥–ª–∏–≤–æ–≥–æ —Ñ–æ–Ω–∞');
            
            if (!rainyBackground) {
                console.error('–≠–ª–µ–º–µ–Ω—Ç rainy-background –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            rainyBackground.innerHTML = '<div class="mist"></div>';
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω
            rainyBackground.style.background = 'linear-gradient(to bottom, #1c262b 0%, #37474f 40%, #455a64 100%)';
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ç—É–º–∞–Ω
            const mist = rainyBackground.querySelector('.mist');
            if (mist) {
                mist.style.background = 'linear-gradient(to bottom, rgba(192, 210, 222, 0.15) 0%, rgba(176, 198, 209, 0.25) 100%)';
                mist.style.opacity = '0.4';
            }
            
            // –°–æ–∑–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∫–∞–ø–ª–∏
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    createRaindrop();
                }, i * 100);
            }
            
            // –ò–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–∞–ø–µ–ª—å
            return setInterval(() => {
                if (document.body.classList.contains('rainy-theme')) {
                    createRaindrop();
                }
            }, 100);
        };
        
        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–¥–Ω–æ–π –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
        function createRaindrop() {
            if (!rainyBackground) return;
            
            const drop = document.createElement('div');
            drop.className = 'raindrop';
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
            drop.style.left = `${Math.random() * 100}%`;
            
            // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
            const duration = 0.5 + Math.random() * 1.5;
            drop.style.setProperty('--duration', `${duration}s`);
            
            // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞—á–∞–ª–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
            drop.style.setProperty('--delay', `${Math.random() * 2}s`);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            rainyBackground.appendChild(drop);
            
            // –£–¥–∞–ª—è–µ–º –∫–∞–ø–ª—é –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                if (drop.parentNode) {
                    drop.parentNode.removeChild(drop);
                }
            }, (duration + parseFloat(drop.style.getPropertyValue('--delay')) + 1) * 1000);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é
        const themeCircleToggle = document.getElementById('theme-circle-toggle');
        const themeCircleMenuItems = document.getElementById('theme-circle-menu-items');
        const themeOptions = document.querySelectorAll('.theme-option');
        
        if (themeCircleToggle && themeCircleMenuItems) {
            console.log('–ö—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏');
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—É–ª—å—Å–∞—Ü–∏–∏
            themeCircleToggle.classList.add('pulse');
            
            // –£–±–∏—Ä–∞–µ–º –ø—É–ª—å—Å–∞—Ü–∏—é —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                themeCircleToggle.classList.remove('pulse');
            }, 5000);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫—Ä—É–∂–∫—É - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é
            themeCircleToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                themeCircleMenuItems.classList.toggle('active');
                console.log('–ú–µ–Ω—é —Ç–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ');
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (themeCircleMenuItems.classList.contains('active') && 
                    !themeCircleMenuItems.contains(e.target) && 
                    e.target !== themeCircleToggle) {
                    themeCircleMenuItems.classList.remove('active');
                    console.log('–ú–µ–Ω—é —Ç–µ–º –∑–∞–∫—Ä—ã—Ç–æ (–∫–ª–∏–∫ –≤–Ω–µ)');
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    console.log(`–í—ã–±—Ä–∞–Ω–∞ —Ç–µ–º–∞: ${theme}`);
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ç–µ–º—É
                    applyTheme(theme);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–µ–º—É –≤ –º–µ–Ω—é
                    themeOptions.forEach(opt => {
                        opt.classList.toggle('active', opt.getAttribute('data-theme') === theme);
                    });
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é
                    themeCircleMenuItems.classList.remove('active');
                });
            });
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            const savedTheme = localStorage.getItem('theme') || 'cosmic';
            console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–∞ —Ç–µ–º–∞:', savedTheme);
            applyTheme(savedTheme);
            
            // –û—Ç–º–µ—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–µ–º—É –≤ –º–µ–Ω—é
            themeOptions.forEach(option => {
                if (option.getAttribute('data-theme') === savedTheme) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
        } else {
            console.error('–û—à–∏–±–∫–∞: –∫—Ä—É–≥–ª–æ–µ –º–µ–Ω—é –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
        function applyTheme(theme) {
            console.log('–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–µ–º–∞:', theme);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –Ω–∞ body
            if (theme === 'cosmic') {
                document.body.classList.remove('rainy-theme');
                document.body.classList.add('cosmic-theme');
            } else if (theme === 'rainy') {
                document.body.classList.remove('cosmic-theme');
                document.body.classList.add('rainy-theme');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Ñ–æ–Ω–æ–≤
            if (enhancedStars && rainyBackground) {
                if (theme === 'cosmic') {
                    enhancedStars.style.display = 'block';
                    rainyBackground.style.display = 'none';
                    
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è
                    const allDrops = document.querySelectorAll('.raindrop');
                    allDrops.forEach(drop => {
                        if (drop.parentNode) drop.parentNode.removeChild(drop);
                    });
                } else if (theme === 'rainy') {
                    enhancedStars.style.display = 'none';
                    rainyBackground.style.display = 'block';
                    
                    // –°–æ–∑–¥–∞–µ–º –¥–æ–∂–¥–ª–∏–≤—ã–π —Ñ–æ–Ω, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                    if (!rainyBackground.querySelector('.raindrop')) {
                        window.createRainyBackground();
                    }
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ localStorage
            localStorage.setItem('theme', theme);
        }
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–æ–≤–æ–≥–æ –º–µ–Ω—é
    function initThemeCircleMenu() {
        // ... existing code ...
    }

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –≤ —Ö–µ–¥–µ—Ä–µ
    document.addEventListener('DOMContentLoaded', function() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–æ–≤–æ–≥–æ –º–µ–Ω—é (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –æ–Ω–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)
        initThemeCircleMenu();
        
        // –ù–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –≤ —Ö–µ–¥–µ—Ä–µ
        const headerThemeToggle = document.querySelector('.theme-toggle');
        
        // –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω
        if (headerThemeToggle) {
            headerThemeToggle.addEventListener('click', function() {
                // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ–º–∞–º–∏
                const currentTheme = localStorage.getItem('theme') || 'default';
                let nextTheme;
                
                // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ç–µ–º—É
                if (currentTheme === 'default') {
                    nextTheme = 'cosmic';
                } else if (currentTheme === 'cosmic') {
                    nextTheme = 'rainy';
                } else {
                    nextTheme = 'default';
                }
                
                // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É
                setTheme(nextTheme);
                
                // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ü–∏–∏ –≤ –∫—Ä—É–≥–æ–≤–æ–º –º–µ–Ω—é (–µ—Å–ª–∏ –æ–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
                updateActiveThemeOption();
            });
        }
    });

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–º—ã –≤ –º–µ–Ω—é
    // ... existing code ...

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –≤ —Ö–µ–¥–µ—Ä–µ
    document.addEventListener('DOMContentLoaded', function() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–æ–≤–æ–≥–æ –º–µ–Ω—é (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –æ–Ω–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)
        // initThemeCircleMenu();
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
        document.addEventListener('themeChanged', function(event) {
            console.log('–°–æ–±—ã—Ç–∏–µ themeChanged –ø–æ–ª—É—á–µ–Ω–æ –≤ main.html, —Ç–µ–º–∞:', event.detail.theme);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫—Ä—É–≥–ª–æ–≥–æ –º–µ–Ω—é –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ü–∏–∏
            const circleThemeOptions = document.querySelectorAll('.theme-circle-menu-items .theme-option');
            if (circleThemeOptions.length > 0) {
                circleThemeOptions.forEach(option => {
                    option.classList.toggle('active', option.getAttribute('data-theme') === event.detail.theme);
                });
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –º–µ–Ω—é –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ü–∏–∏
            const standardThemeOptions = document.querySelectorAll('.theme-menu .theme-option');
            if (standardThemeOptions.length > 0) {
                standardThemeOptions.forEach(option => {
                    option.classList.toggle('active', option.getAttribute('data-theme') === event.detail.theme);
                });
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç—ã–µ –∫–Ω–æ–ø–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
            try {
                const simpleCosmicBtn = document.getElementById('simple-cosmic-button');
                const simpleRainyBtn = document.getElementById('simple-rainy-button');
                
                if (simpleCosmicBtn && simpleRainyBtn) {
                    if (event.detail.theme === 'cosmic') {
                        simpleCosmicBtn.classList.add('active');
                        simpleRainyBtn.classList.remove('active');
                    } else if (event.detail.theme === 'rainy') {
                        simpleRainyBtn.classList.add('active');
                        simpleCosmicBtn.classList.remove('active');
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∫–Ω–æ–ø–æ–∫:', error);
            }
        });
    });

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–º—ã –≤ –º–µ–Ω—é
    // ... existing code ...

    // –°–ª—É—à–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
    document.addEventListener('themeChanged', function(e) {
        console.log('–°–æ–±—ã—Ç–∏–µ —Å–º–µ–Ω—ã —Ç–µ–º—ã –ø–æ–ª—É—á–µ–Ω–æ, –Ω–æ–≤–∞—è —Ç–µ–º–∞:', e.detail.theme);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º QR-–∫–æ–¥ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è –Ω–æ–≤–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞
        if (newsItems.length > 0 && currentNewsIndex >= 0) {
            updateQRCode(newsItems[currentNewsIndex]);
        }
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è QR-–∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é –∏—Å—Ç–æ—á–Ω–∏–∫–∞
    function updateNewsQRCode(sourceUrl) {
        // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¶–ë –†–§
        let qrCode = qrCodeSources['cbr.ru'];
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ URL
        if (sourceUrl.includes('cbr.ru') || sourceUrl.includes('centralbank')) {
            qrCode = qrCodeSources['cbr.ru'];
        } else if (sourceUrl.includes('kommersant.ru') || sourceUrl.includes('kommersant')) {
            qrCode = qrCodeSources['kommersant.ru'];
        } else if (sourceUrl.includes('rambler.ru') || sourceUrl.includes('rambler')) {
            qrCode = qrCodeSources['rambler.ru'];
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–µ–º—É
        const isRainyTheme = document.body.classList.contains('rainy-theme');
        const imageUrl = isRainyTheme && qrCode.rainyUrl ? qrCode.rainyUrl : qrCode.url;
        
        // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
        console.log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ QR-–∫–æ–¥–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã:');
        console.log('–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ–≤–æ—Å—Ç–∏:', sourceUrl);
        console.log('–í—ã–±—Ä–∞–Ω QR-–∫–æ–¥ –¥–ª—è:', qrCode.name);
        console.log('–î–æ–∂–¥–ª–∏–≤–∞—è —Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞:', isRainyTheme);
        console.log('–ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é QR-–∫–æ–¥–∞:', imageUrl);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º QR-–∫–æ–¥ –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏
        const qrCodeImage = document.getElementById('qr-image');
        qrCodeImage.src = imageUrl;
        qrCodeImage.alt = qrCode.name;
        qrSource.textContent = qrCode.name;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        qrCodeImage.onload = function() {
            console.log('QR-–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ç–µ–º—ã:', imageUrl);
        };
        
        qrCodeImage.onerror = function() {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ QR-–∫–æ–¥–∞ –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ç–µ–º—ã:', imageUrl);
            console.log('–ü–æ–ª–Ω—ã–π URL –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ Django:', this.src);
        };
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è QR-–∫–æ–¥–∞ –Ω–æ–≤–æ—Å—Ç–∏
</script>
{% endblock %}
